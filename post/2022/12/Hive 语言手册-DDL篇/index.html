<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/img/logo.png"><title>Hive 基本概念 DDL篇 | Xiaobailong</title><meta name="description" content="Xiaobailong's blog.">
    <link rel="modulepreload" href="/assets/app.7f79d2e7.js"><link rel="modulepreload" href="/assets/index.html.98dcd658.js"><link rel="modulepreload" href="/assets/index.html.db9688e0.js"><link rel="prefetch" href="/assets/index.html.0bfc2a63.js"><link rel="prefetch" href="/assets/index.html.96d0d331.js"><link rel="prefetch" href="/assets/index.html.b339f918.js"><link rel="prefetch" href="/assets/index.html.de623cb7.js"><link rel="prefetch" href="/assets/index.html.f894b5dc.js"><link rel="prefetch" href="/assets/index.html.e8c2580a.js"><link rel="prefetch" href="/assets/404.html.7d858b3d.js"><link rel="prefetch" href="/assets/index.html.de26035a.js"><link rel="prefetch" href="/assets/index.html.4a704eac.js"><link rel="prefetch" href="/assets/index.html.64e1d95f.js"><link rel="prefetch" href="/assets/index.html.177c9b91.js"><link rel="prefetch" href="/assets/index.html.8f8264a6.js"><link rel="prefetch" href="/assets/index.html.7a47c908.js"><link rel="prefetch" href="/assets/index.html.deae5fb3.js"><link rel="prefetch" href="/assets/index.html.326c9086.js"><link rel="prefetch" href="/assets/index.html.bb3724b2.js"><link rel="prefetch" href="/assets/index.html.291dcd4a.js"><link rel="prefetch" href="/assets/index.html.ff07d35e.js"><link rel="prefetch" href="/assets/index.html.b2d8f580.js"><link rel="prefetch" href="/assets/index.html.b082eec6.js"><link rel="prefetch" href="/assets/404.html.f7ba0a0f.js"><link rel="prefetch" href="/assets/index.html.3a3f645d.js"><link rel="prefetch" href="/assets/index.html.ee2688a1.js"><link rel="prefetch" href="/assets/index.html.cf53be78.js"><link rel="prefetch" href="/assets/index.html.0f456be9.js"><link rel="prefetch" href="/assets/index.html.999e17d5.js"><link rel="prefetch" href="/assets/index.html.7efde9f8.js"><link rel="prefetch" href="/assets/index.html.c78de1fc.js"><link rel="prefetch" href="/assets/404.3c91153c.js"><link rel="prefetch" href="/assets/HomePage.8dd37360.js"><link rel="prefetch" href="/assets/Layout.a9b3424b.js"><link rel="prefetch" href="/assets/Links.0010d432.js"><link rel="prefetch" href="/assets/Post.823acb2f.js"><link rel="prefetch" href="/assets/Tags.30661a21.js">
    <link rel="stylesheet" href="/assets/style.d9da5232.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar invert"><span><a href="/" class=""><span class="site-name">$ cd /home/</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor"><!--[--><!--]--></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/links/" class="" aria-label="Links"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor"><!--[--><!--]--></svg></span><span>Links</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor"><!--[--><!--]--></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/links/" class="" aria-label="Links"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor"><!--[--><!--]--></svg></span><span>Links</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><div class="page-content"><!--[--><div class="show-catalog post-wrapper"><div class="article-header use-image post-header" style="background-image:url(/img/blog_cover/2022/12/2022-12-12-1.jpg);"><div class="article-header-mask" style="background:rgba(40, 57, 101, .4);"></div><div class="article-header-content"><div class="article-tags"><!--[--><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="article-tag">大数据</a><a href="/tags/hive/" class="article-tag">Hive</a><!--]--></div><h1 class="article-title">Hive 基本概念 DDL篇</h1><p class="article-subtitle">随便看看，别要求太过分</p><div class="article-icons"><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg><span>Xiaobailong</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg><span>2022-12-15</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg><span>99 min</span></div></div></div><!----></div><main class="page post-content"><!--[--><!--]--><div class="theme-gungnir-content"><!--[--><!--]--><div><h1 id="hiveql-语言手册-ddl篇" tabindex="-1"><a class="header-anchor" href="#hiveql-语言手册-ddl篇" aria-hidden="true">#</a> HiveQL 语言手册 DDL篇</h1><h2 id="概览" tabindex="-1"><a class="header-anchor" href="#概览" aria-hidden="true">#</a> 概览</h2><p>HiveQL DDL 所包含的表达式语句如下：</p><ul><li>CREATE DATABASE/SCHEMA, TABLE, VIEW, FUNCTION, INDEX</li><li>DROP DATABASE/SCHEMA, TABLE, VIEW, INDEX</li><li>TRUNCATE TABLE</li><li>ALTER DATABASE/SCHEMA, TABLE, VIEW</li><li>MSCK REPAIR TABLE (or ALTER TABLE RECOVER PARTITIONS)</li><li>SHOW DATABASES/SCHEMAS, TABLES, TBLPROPERTIES, VIEWS, PARTITIONS, FUNCTIONS, INDEX[ES], COLUMNS, CREATE TABLE</li><li>DESCRIBE DATABASE/SCHEMA, table_name, view_name, materialized_view_name</li></ul><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">可选</p><p>PARTITION 语句通常是 TABLE 语句的可选项，除了SHOW PARTITIONS。</p></div><h2 id="关键字" tabindex="-1"><a class="header-anchor" href="#关键字" aria-hidden="true">#</a> 关键字</h2><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">所有关键字</th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;">版本</td><td style="text-align:left;">非保留关键字</td><td style="text-align:left;">保留关键字</td></tr><tr><td style="text-align:left;">Hive 1.2.0</td><td style="text-align:left;"><code>ADD, ADMIN, AFTER, ANALYZE, ARCHIVE, ASC, BEFORE, BUCKET, BUCKETS, CASCADE, CHANGE, CLUSTER, CLUSTERED, CLUSTERSTATUS, COLLECTION, COLUMNS, COMMENT, COMPACT, COMPACTIONS, COMPUTE, CONCATENATE, CONTINUE, DATA, DATABASES, DATETIME, DAY, DBPROPERTIES, DEFERRED, DEFINED, DELIMITED, DEPENDENCY, DESC, DIRECTORIES, DIRECTORY, DISABLE, DISTRIBUTE, ELEM_TYPE, ENABLE, ESCAPED, EXCLUSIVE, EXPLAIN, EXPORT, FIELDS, FILE, FILEFORMAT, FIRST, FORMAT, FORMATTED, FUNCTIONS, HOLD_DDLTIME, HOUR, IDXPROPERTIES, IGNORE, INDEX, INDEXES, INPATH, INPUTDRIVER, INPUTFORMAT, ITEMS, JAR, KEYS, KEY_TYPE, LIMIT, LINES, LOAD, LOCATION, LOCK, LOCKS, LOGICAL, LONG, MAPJOIN, MATERIALIZED, METADATA, MINUS, MINUTE, MONTH, MSCK, NOSCAN, NO_DROP, OFFLINE, OPTION, OUTPUTDRIVER, OUTPUTFORMAT, OVERWRITE, OWNER, PARTITIONED, PARTITIONS, PLUS, PRETTY, PRINCIPALS, PROTECTION, PURGE, READ, READONLY, REBUILD, RECORDREADER, RECORDWRITER, REGEXP, RELOAD, RENAME, REPAIR, REPLACE, REPLICATION, RESTRICT, REWRITE, RLIKE, ROLE, ROLES, SCHEMA, SCHEMAS, SECOND, SEMI, SERDE, SERDEPROPERTIES, SERVER, SETS, SHARED, SHOW, SHOW_DATABASE, SKEWED, SORT, SORTED, SSL, STATISTICS, STORED, STREAMTABLE, STRING, STRUCT, TABLES, TBLPROPERTIES, TEMPORARY, TERMINATED, TINYINT, TOUCH, TRANSACTIONS, UNARCHIVE, UNDO, UNIONTYPE, UNLOCK, UNSET, UNSIGNED, URI, USE, UTC, UTCTIMESTAMP, VALUE_TYPE, VIEW, WHILE, YEAR</code></td><td style="text-align:left;"><code>ALL, ALTER, AND, ARRAY, AS, AUTHORIZATION, BETWEEN, BIGINT, BINARY, BOOLEAN, BOTH, BY, CASE, CAST, CHAR, COLUMN, CONF, CREATE, CROSS, CUBE, CURRENT, CURRENT_DATE, CURRENT_TIMESTAMP, CURSOR, DATABASE, DATE, DECIMAL, DELETE, DESCRIBE, DISTINCT, DOUBLE, DROP, ELSE, END, EXCHANGE, EXISTS, EXTENDED, EXTERNAL, FALSE, FETCH, FLOAT, FOLLOWING, FOR, FROM, FULL, FUNCTION, GRANT, GROUP, GROUPING, HAVING, IF, IMPORT, IN, INNER, INSERT, INT, INTERSECT, INTERVAL, INTO, IS, JOIN, LATERAL, LEFT, LESS, LIKE, LOCAL, MACRO, MAP, MORE, NONE, NOT, NULL, OF, ON, OR, ORDER, OUT, OUTER, OVER, PARTIALSCAN, PARTITION, PERCENT, PRECEDING, PRESERVE, PROCEDURE, RANGE, READS, REDUCE, REVOKE, RIGHT, ROLLUP, ROW, ROWS, SELECT, SET, SMALLINT, TABLE, TABLESAMPLE, THEN, TIMESTAMP, TO, TRANSFORM, TRIGGER, TRUE, TRUNCATE, UNBOUNDED, UNION, UNIQUEJOIN, UPDATE, USER, USING, UTC_TMESTAMP, VALUES, VARCHAR, WHEN, WHERE, WINDOW, WITH</code></td></tr><tr><td style="text-align:left;">Hive 2.0.0</td><td style="text-align:left;"><em>移除：</em> <code>REGEXP, RLIKE</code><br><em>添加：</em> <code>AUTOCOMMIT, ISOLATION, LEVEL, OFFSET, SNAPSHOT, TRANSACTION, WORK, WRITE</code></td><td style="text-align:left;"><em>添加：</em><code>COMMIT, ONLY, REGEXP, RLIKE, ROLLBACK, START</code></td></tr><tr><td style="text-align:left;">Hive 2.1.0</td><td style="text-align:left;"><em>添加：</em><code>ABORT, KEY, LAST, NORELY, NOVALIDATE, NULLS, RELY, VALIDATE</code></td><td style="text-align:left;"><em>添加：</em><code>CACHE, CONSTRAINT, FOREIGN, PRIMARY, REFERENCES</code></td></tr><tr><td style="text-align:left;">Hive 2.2.0</td><td style="text-align:left;"><em>添加：</em> <code>DETAIL, DOW, EXPRESSION, OPERATOR, QUARTER, SUMMARY, VECTORIZATION, WEEK, YEARS, MONTHS, WEEKS, DAYS, HOURS, MINUTES, SECONDS</code></td><td style="text-align:left;"><em>添加：</em><code>DAYOFWEEK, EXTRACT, FLOOR, INTEGER, PRECISION, VIEWS</code></td></tr><tr><td style="text-align:left;">Hive 3.0.0</td><td style="text-align:left;"><em>添加：</em><code>TIMESTAMPTZ, ZONE </code></td><td style="text-align:left;"><em>添加：</em><code>TIME, NUMERIC, SYNC</code></td></tr></tbody></table><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>REGEXP 和 RLIKE 是 Hive 2.0.0 之前的非保留关键字，从Hive 2.0.0 (<a href="https://issues.apache.org/jira/browse/HIVE-11703" target="_blank" rel="noopener noreferrer">Hive -11703</a>)开始改为保留关键字。</p></div><p>为减少程序中的语义冲突，从 Hive1.2.0 版本开始大多数非保留关键字被加入到保留关键字中。但是如果用户仍想使用保留关键字作为标识符，有两种方法：</p><ol><li>使用反撇号(`)将关键字包裹（指键盘Esc下面的那个符号）</li><li>通过设置绕过关键字校验，<code>set hive.support.sql11.reserved.keywords=false</code>. (这需要 Hive 2.1.0 之后的版本)</li></ol><h2 id="create-drop-alter-use-database" tabindex="-1"><a class="header-anchor" href="#create-drop-alter-use-database" aria-hidden="true">#</a> Create/Drop/Alter/Use Database</h2><h3 id="create-database" tabindex="-1"><a class="header-anchor" href="#create-database" aria-hidden="true">#</a> Create Database</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span>REMOTE<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> database_name
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> database_comment<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>MANAGEDLOCATION hdfs_path<span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">WITH</span> DBPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>在Hive 0.6 (<a href="https://issues.apache.org/jira/browse/HIVE-675" target="_blank" rel="noopener noreferrer">Hive -675</a>)中，添加了<code>CREATE DATABASE</code>子句。</p><p>在Hive 0.7 (<a href="https://issues.apache.org/jira/browse/HIVE-1836" target="_blank" rel="noopener noreferrer">Hive -1836</a>)中，添加了<code>WITH DBPROPERTIES</code>子句。</p><p>在Hive 4.0.0 (<a href="https://issues.apache.org/jira/browse/HIVE-22995" target="_blank" rel="noopener noreferrer">HIVE-22995</a>)中，添加了<code>MANAGEDLOCATION</code>子句 。</p></div><ul><li><code>SCHEMA</code>和<code>DATABASE</code>的用法相同，在Hive中它们所传达的意思是一致的。</li><li><code>COMMENT</code>用于数据库添加注释。</li><li><code>LOCATION</code>用于指定外部表的默认路径。</li><li><code>MANAGEDLOCATION</code>用于指定内部表的默认路径。</li><li><code>WITH DBPROPERTIES</code>用于为数据库添加其他属性。</li></ul><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">使用建议</p><p>在设置<code>MANAGEDLOCATION</code>的位置时，尽量使其位于<code>metastore.warehouse.dir</code>（Hive数据库文件存放的根目录）中，这样所有内部表都有一个共同的根目录，有助于有公共管理。可以通过设置<code>metastore.warehouse.tenant.colocation</code> 使其他使用者有一个属于自己的根目录，使其与公共目录分离开，以便管理。</p></div><h3 id="drop-database" tabindex="-1"><a class="header-anchor" href="#drop-database" aria-hidden="true">#</a> Drop Database</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> database_name <span class="token punctuation">[</span><span class="token keyword">RESTRICT</span><span class="token operator">|</span><span class="token keyword">CASCADE</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>在Hive 0.6 (<a href="https://issues.apache.org/jira/browse/HIVE-675" target="_blank" rel="noopener noreferrer">Hive -675</a>)中，添加了<code>DROP DATABASE</code>子句 。</p><p>在Hive 0.8 (<a href="https://issues.apache.org/jira/browse/HIVE-2090" target="_blank" rel="noopener noreferrer">HIVE-2090</a>)中，添加了<code>RESTRICT | CASCADE</code>子句。</p></div><ul><li><code>SCHEMA</code>和<code>DATABASE</code>的用法相同，在Hive中它们所传达的意思是一致的。</li><li>在执行<code>Drop Database</code>时，默认使用 <code>RESTRICT</code>模式，在该模式下，如果删除的数据库非空，则会执行失败，从而保护数据库被误删。</li><li>如果想要在删除库的同时也将库中所有的表删除，需要使用<code>DROP DATABASE ... CASCADE</code>语句（暴力操作，慎用）。</li></ul><h3 id="alter-database" tabindex="-1"><a class="header-anchor" href="#alter-database" aria-hidden="true">#</a> Alter Database</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- (Note: SCHEMA added in Hive 0.14.0)</span>
<span class="token keyword">ALTER</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> database_name <span class="token keyword">SET</span> DBPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   

<span class="token comment">-- (Note: Hive 0.13.0 and later; SCHEMA added in Hive 0.14.0)</span>
<span class="token keyword">ALTER</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> database_name <span class="token keyword">SET</span> OWNER <span class="token punctuation">[</span><span class="token keyword">USER</span><span class="token operator">|</span>ROLE<span class="token punctuation">]</span> user_or_role<span class="token punctuation">;</span>   

<span class="token comment">-- (Note: Hive 2.2.1, 2.4.0 and later)</span>
<span class="token keyword">ALTER</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> database_name <span class="token keyword">SET</span> LOCATION hdfs_path<span class="token punctuation">;</span> 

<span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
<span class="token keyword">ALTER</span> <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> database_name <span class="token keyword">SET</span> MANAGEDLOCATION hdfs_path<span class="token punctuation">;</span> 
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>在Hive 0.14 (<a href="https://issues.apache.org/jira/browse/HIVE-6601" target="_blank" rel="noopener noreferrer">HIVE-6601</a>)中添加了<code>ALTER SCHEMA</code></p></div><ul><li><code>SCHEMA</code>和<code>DATABASE</code>的用法相同，在Hive中它们所传达的意思是一致的。</li><li><code>ALTER DATABASE…SET LOCATION</code>语句，用于修改数据库下外表的默认存储目录。不会将数据库当前已存在的目录及文件移动到新指定的位置，只有在该数据库中添加新表时使用修改后的默认目录。</li><li><code>ALTER DATABASE…SET MANAGEDLOCATION</code>语句，用于修改数据库下内表的默认存储目录。不会将数据库当前已存在的目录及文件移动到新指定的位置，只有在该数据库中添加新表时使用修改后的默认目录。</li></ul><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">TIP</p><p>除了上述的这些元数据外，数据库的其他元数据不支持在创建后再修改。</p></div><h3 id="use-database" tabindex="-1"><a class="header-anchor" href="#use-database" aria-hidden="true">#</a> Use Database</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">USE</span> database_name<span class="token punctuation">;</span>
<span class="token keyword">USE</span> <span class="token keyword">DEFAULT</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>在Hive 0.6 (<a href="https://issues.apache.org/jira/browse/HIVE-675" target="_blank" rel="noopener noreferrer">HIVE-675</a>)中添加了<code>USE database_name</code> 。</p></div><ul><li><code>USE DATABASE_NAME</code>，为所有后续HiveQL语句设置指定数据库。</li><li><code>USE DEFAULT</code>，将数据库切换为DEFAULT数据库。</li><li><code>SELECT current_database()</code>，查看当前所属数据库 (在<a href="https://issues.apache.org/jira/browse/HIVE-4144" target="_blank" rel="noopener noreferrer">Hive 0.13.0</a>之后可用)。</li></ul><h2 id="create-drop-alter-connector" tabindex="-1"><a class="header-anchor" href="#create-drop-alter-connector" aria-hidden="true">#</a> Create/Drop/Alter Connector</h2><h3 id="create-connector" tabindex="-1"><a class="header-anchor" href="#create-connector" aria-hidden="true">#</a> Create Connector</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> CONNECTOR <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> connector_name
  <span class="token punctuation">[</span><span class="token keyword">TYPE</span> datasource_type<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>URL datasource_url<span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> connector_comment<span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">WITH</span> DCPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 4.0.0(<a href="https://issues.apache.org/jira/browse/HIVE-24396" target="_blank" rel="noopener noreferrer">Hive -24396</a>)开始，添加了对<code>Data connectors</code>的支持。支持基于JDBC的Connector（如MYSQL、POSTGRES、DERBY）。后续将逐步添加其他类型的Connector。</p></div><ul><li><code>TYPE</code> - 用于指定远程数据源的类型。如：MYSQL。该类型决定了驱动程序类和可用的数据源参数。</li><li><code>URL</code> - 远程数据源的URL。 JDBC 数据源，填写 JDBC URL。Hive数据源，填写Thrift URL。</li><li><code>COMMENT</code> - 连接器的注释及描述。</li><li><code>DCPROPERTIES</code>：连接器的相关属性设置，每个属性设定均由一组Key/Value组成。</li></ul><h3 id="drop-connector" tabindex="-1"><a class="header-anchor" href="#drop-connector" aria-hidden="true">#</a> Drop Connector</h3><div class="language-text ext-text"><pre class="language-text"><code>DROP CONNECTOR [IF EXISTS] connector_name;
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 4.0.0 via <a href="https://issues.apache.org/jira/browse/HIVE-24396" target="_blank" rel="noopener noreferrer">HIVE-24396</a>开始。即便该Connector已经映射了数据库，执行drop时仍会成功。但在执行<code>show tables</code>之类的ddl语句时，用户将看到错误（Connector已不存在）。</p></div><h3 id="alter-connector" tabindex="-1"><a class="header-anchor" href="#alter-connector" aria-hidden="true">#</a> Alter Connector</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> CONNECTOR connector_name <span class="token keyword">SET</span> DCPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">ALTER</span> CONNECTOR connector_name <span class="token keyword">SET</span> URL new_url<span class="token punctuation">;</span>
  
<span class="token keyword">ALTER</span> CONNECTOR connector_name <span class="token keyword">SET</span> OWNER <span class="token punctuation">[</span><span class="token keyword">USER</span><span class="token operator">|</span>ROLE<span class="token punctuation">]</span> user_or_role<span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 4.0.0 via <a href="https://issues.apache.org/jira/browse/HIVE-24396" target="_blank" rel="noopener noreferrer">HIVE-24396</a>开始，支持ALTER Connector相关的操作。</p></div><ul><li><code>ALTER CONNECTOR ... SET DCPROPERTIES</code> ，修改现有的Connector属性。</li><li><code>ALTER CONNECTOR ... SET URL</code>， 替换远程数据源URL。使用连接器创建的REMOTE数据库都将继续工作，因为它们是按名称关联的。</li><li><code>ALTER CONNECTOR ... SET OWNER</code> ，更改hive中连接器的所有者。</li></ul><h2 id="create-drop-truncate-table" tabindex="-1"><a class="header-anchor" href="#create-drop-truncate-table" aria-hidden="true">#</a> Create/Drop/Truncate Table</h2><h3 id="create-table" tabindex="-1"><a class="header-anchor" href="#create-table" aria-hidden="true">#</a> Create Table</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">TEMPORARY</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>EXTERNAL<span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name    <span class="token comment">-- (Note: TEMPORARY available in Hive 0.14.0 and later)</span>
  <span class="token punctuation">[</span><span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span>column_constraint_specification<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">[</span>constraint_specification<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> table_comment<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">CLUSTERED</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>SORTED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name <span class="token punctuation">[</span><span class="token keyword">ASC</span><span class="token operator">|</span><span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">INTO</span> num_buckets BUCKETS<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>SKEWED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>                  <span class="token comment">-- (Note: Available in Hive 0.10.0 and later)]</span>
     <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>col_value<span class="token punctuation">,</span> col_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>col_value<span class="token punctuation">,</span> col_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
     <span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> DIRECTORIES<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>
   <span class="token punctuation">[</span><span class="token keyword">ROW</span> FORMAT row_format<span class="token punctuation">]</span> 
   <span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> file_format<span class="token punctuation">]</span>
     <span class="token operator">|</span> STORED <span class="token keyword">BY</span> <span class="token string">&#39;storage.handler.class.name&#39;</span> <span class="token punctuation">[</span><span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">-- (Note: Available in Hive 0.6.0 and later)</span>
  <span class="token punctuation">]</span>
  <span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>TBLPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token comment">-- (Note: Available in Hive 0.6.0 and later)</span>
  <span class="token punctuation">[</span><span class="token keyword">AS</span> select_statement<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Available in Hive 0.5.0 and later; not supported for external tables)</span>
 
<span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">TEMPORARY</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>EXTERNAL<span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name
  <span class="token operator">LIKE</span> existing_table_or_view_name
  <span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
data_type
  : primitive_type
  <span class="token operator">|</span> array_type
  <span class="token operator">|</span> map_type
  <span class="token operator">|</span> struct_type
  <span class="token operator">|</span> union_type  <span class="token comment">-- (Note: Available in Hive 0.7.0 and later)</span>
 
primitive_type
  : <span class="token keyword">TINYINT</span>
  <span class="token operator">|</span> <span class="token keyword">SMALLINT</span>
  <span class="token operator">|</span> <span class="token keyword">INT</span>
  <span class="token operator">|</span> <span class="token keyword">BIGINT</span>
  <span class="token operator">|</span> <span class="token keyword">BOOLEAN</span>
  <span class="token operator">|</span> <span class="token keyword">FLOAT</span>
  <span class="token operator">|</span> <span class="token keyword">DOUBLE</span>
  <span class="token operator">|</span> <span class="token keyword">DOUBLE</span> <span class="token keyword">PRECISION</span> <span class="token comment">-- (Note: Available in Hive 2.2.0 and later)</span>
  <span class="token operator">|</span> STRING
  <span class="token operator">|</span> <span class="token keyword">BINARY</span>      <span class="token comment">-- (Note: Available in Hive 0.8.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">TIMESTAMP</span>   <span class="token comment">-- (Note: Available in Hive 0.8.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">DECIMAL</span>     <span class="token comment">-- (Note: Available in Hive 0.11.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token keyword">precision</span><span class="token punctuation">,</span> scale<span class="token punctuation">)</span>  <span class="token comment">-- (Note: Available in Hive 0.13.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">DATE</span>        <span class="token comment">-- (Note: Available in Hive 0.12.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">VARCHAR</span>     <span class="token comment">-- (Note: Available in Hive 0.12.0 and later)</span>
  <span class="token operator">|</span> <span class="token keyword">CHAR</span>        <span class="token comment">-- (Note: Available in Hive 0.13.0 and later)</span>
 
array_type
  : ARRAY <span class="token operator">&lt;</span> data_type <span class="token operator">&gt;</span>
 
map_type
  : MAP <span class="token operator">&lt;</span> primitive_type<span class="token punctuation">,</span> data_type <span class="token operator">&gt;</span>
 
struct_type
  : STRUCT <span class="token operator">&lt;</span> col_name : data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span>
 
union_type
   : UNIONTYPE <span class="token operator">&lt;</span> data_type<span class="token punctuation">,</span> data_type<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&gt;</span>  <span class="token comment">-- (Note: Available in Hive 0.7.0 and later)</span>
 
row_format
  : DELIMITED <span class="token punctuation">[</span><span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token keyword">char</span> <span class="token punctuation">[</span><span class="token keyword">ESCAPED</span> <span class="token keyword">BY</span> <span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>COLLECTION ITEMS <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token keyword">char</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>MAP <span class="token keyword">KEYS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token keyword">char</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token keyword">char</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token boolean">NULL</span> DEFINED <span class="token keyword">AS</span> <span class="token keyword">char</span><span class="token punctuation">]</span>   <span class="token comment">-- (Note: Available in Hive 0.13 and later)</span>
  <span class="token operator">|</span> SERDE serde_name <span class="token punctuation">[</span><span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 
file_format:
  : SEQUENCEFILE
  <span class="token operator">|</span> TEXTFILE    <span class="token comment">-- (Default, depending on hive.default.fileformat configuration)</span>
  <span class="token operator">|</span> RCFILE      <span class="token comment">-- (Note: Available in Hive 0.6.0 and later)</span>
  <span class="token operator">|</span> ORC         <span class="token comment">-- (Note: Available in Hive 0.11.0 and later)</span>
  <span class="token operator">|</span> PARQUET     <span class="token comment">-- (Note: Available in Hive 0.13.0 and later)</span>
  <span class="token operator">|</span> AVRO        <span class="token comment">-- (Note: Available in Hive 0.14.0 and later)</span>
  <span class="token operator">|</span> JSONFILE    <span class="token comment">-- (Note: Available in Hive 4.0.0 and later)</span>
  <span class="token operator">|</span> INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname
 
column_constraint_specification:
  : <span class="token punctuation">[</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token operator">|</span><span class="token keyword">UNIQUE</span><span class="token operator">|</span><span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token operator">|</span><span class="token keyword">DEFAULT</span> <span class="token punctuation">[</span>default_value<span class="token punctuation">]</span><span class="token operator">|</span><span class="token keyword">CHECK</span>  <span class="token punctuation">[</span>check_expression<span class="token punctuation">]</span> <span class="token keyword">ENABLE</span><span class="token operator">|</span><span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token operator">/</span>NORELY <span class="token punctuation">]</span>
 
default_value:
  : <span class="token punctuation">[</span> LITERAL<span class="token operator">|</span><span class="token keyword">CURRENT_USER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token keyword">CURRENT_DATE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token boolean">NULL</span> <span class="token punctuation">]</span> 
 
constraint_specification:
  : <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token operator">/</span>NORELY <span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token operator">/</span>NORELY <span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> table_name<span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE 
    <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token operator">/</span>NORELY <span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">CHECK</span> <span class="token punctuation">[</span>check_expression<span class="token punctuation">]</span> <span class="token keyword">ENABLE</span><span class="token operator">|</span><span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token operator">/</span>NORELY <span class="token punctuation">]</span>
</code></pre></div><p><code>CREATE TABLE</code> 创建给定名称的表。如果已经存在同名的表或视图，则抛出异常。可以使用<code>IF NOT EXISTS</code>来跳过这个错误。</p><ul><li><p>在建表时，表名和列名不区分大小写，但是<code>SerDe</code>和<code>property </code>的内容区分大小写</p><ul><li>在Hive 0.12及更早的版本，表名和列名中只允许使用字母数字和下划线字符。</li><li>在Hive 0.13及以后的版本，列名可以使用所有的Unicode字符(参见<a href="https://issues.apache.org/jira/browse/HIVE-6013" target="_blank" rel="noopener noreferrer">HIVE-6013</a>)，注：（除了点和冒号，这会使查询报错，因此在Hive 1.2.0中不允许使用它们(参见<a href="https://issues.apache.org/jira/browse/HIVE-10120" target="_blank" rel="noopener noreferrer">HIVE-10120</a>)）。如果在表名或列名中使用到了特殊字符或保留关键字，可以使用反撇号(`)包裹，这样就可以强制使用了。</li><li>如果想要恢复到Hive 0.13之前的设定，即将列名限制为只允许字母数字和下划线字符，可通过配置属性来启用<code>hive.support.quotes.identifiers=none</code>。启用该配置后，反撇号(`)包含的内容将被解释为正则表达式。有关更多详细信息，请参见<a href="https://issues.apache.org/jira/secure/attachment/12618321/QuotedIdentifier.html" target="_blank" rel="noopener noreferrer">Supporting Quoted Identifiers in Column Names</a>。</li></ul></li><li><p>表及列的注释都是字符型的 (需要用单引号引用)。</p></li><li><p>建表时如果不使用<code>EXTERNAL</code>创建，默认建出来的就是内表，并由Hive管理它的数据。</p><ul><li>要确定某个表是内部表的还是外部表，可以使用 <code>DESCRIBE EXTENDED table_name</code> 进行查看。</li></ul></li><li><p><code>TBLPROPERTIES</code>子句，允许用户添加表属性，通过key/value的形式对其标记。表默认存在一些预定义的表属性，如<code>last_modified_user</code>和<code>last_modified_time</code>，这些属性是由Hive自动添加和管理的。其他预定义的表属性包括：</p><ul><li>TBLPROPERTIES (&quot;comment&quot;=&quot;<em>table_comment</em>&quot;)</li><li>TBLPROPERTIES (&quot;hbase.table.name&quot;=&quot;<em>table_name</em>&quot;)</li><li>TBLPROPERTIES (&quot;immutable&quot;=&quot;true&quot;) or (&quot;immutable&quot;=&quot;false&quot;)</li><li>TBLPROPERTIES (&quot;orc.compress&quot;=&quot;ZLIB&quot;) or (&quot;orc.compress&quot;=&quot;SNAPPY&quot;) or (&quot;orc.compress&quot;=&quot;NONE&quot;) and other ORC properties</li><li>TBLPROPERTIES (&quot;transactional&quot;=&quot;true&quot;) or (&quot;transactional&quot;=&quot;false&quot;)</li><li>TBLPROPERTIES (&quot;NO_AUTO_COMPACTION&quot;=&quot;true&quot;) or (&quot;NO_AUTO_COMPACTION&quot;=&quot;false&quot;),</li><li>TBLPROPERTIES (&quot;compactor.mapreduce.map.memory.mb&quot;=&quot;<em>mapper_memory&quot;</em>)</li><li>TBLPROPERTIES (&quot;compactorthreshold.hive.compactor.delta.num.threshold&quot;=&quot;<em>threshold_num</em>&quot;)</li><li>TBLPROPERTIES (&quot;compactorthreshold.hive.compactor.delta.pct.threshold&quot;=&quot;<em>threshold_pct</em>&quot;)</li><li>TBLPROPERTIES (&quot;auto.purge&quot;=&quot;true&quot;) or (&quot;auto.purge&quot;=&quot;false&quot;)</li><li>TBLPROPERTIES (&quot;EXTERNAL&quot;=&quot;TRUE&quot;)</li><li>TBLPROPERTIES (&quot;external.table.purge&quot;=&quot;true&quot;)</li></ul></li><li><p>在建表时，如果要为表指定数据库，有两种方法：</p><ul><li>在执行CREATE TABLE语句前，使用USE database_name语句指定数据库(<a href="https://issues.apache.org/jira/browse/HIVE-675" target="_blank" rel="noopener noreferrer">Hive 0.6</a>及以后版本支持)，如果不指定创建的表默认将归属default数据库。</li><li>在执行CREATE TABLE语句时，在建表语句中加入数据库名(Hive 0.7及以后版本支持)，格式为：<code>database_name.table.name</code>。</li></ul></li></ul><h4 id="storage-formats" tabindex="-1"><a class="header-anchor" href="#storage-formats" aria-hidden="true">#</a> Storage Formats</h4><p>Hive支持内置的几种文件格式，同时也支持自定义开发的文件格式。有关压缩表存储的详细信息，请参阅CompressedStorage。</p><p>以下是Hive内置的一些格式：</p><table><thead><tr><th style="text-align:left;">存储格式</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">STORED AS TEXTFILE</td><td style="text-align:left;">存储为纯文本文件。<code>TEXTFILE</code> 是默认的存储格式，如果想修改Hive的默认存储格式，通过<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.default.fileformat" target="_blank" rel="noopener noreferrer">hive.default.fileformat</a>参数进行调整。<br><br>使用<code>DELIMITED</code>中的定义，读取带分隔符的文件。<br><br>通过使用<code>escaping by</code>(例如<code>escape by &#39;\&#39;</code>)为分隔符启用转义，如果要处理包含这些分隔符字符的数据，则需要转义。<br><br>还可以使用<code>NULL DEFINED AS</code>(默认为&#39;\N&#39;)指定自定义NULL格式。<br><br>(Hive 4.0)表中的所有二进制列都被假设为base64编码。以原始字节的形式读取数据:<br>TBLPROPERTIES (&quot;hive.serialization.decode.binary.as.base64&quot;=&quot;false&quot;)</td></tr><tr><td style="text-align:left;">STORED AS SEQUENCEFILE</td><td style="text-align:left;">存储为压缩序列文件。</td></tr><tr><td style="text-align:left;">STORED AS ORC</td><td style="text-align:left;">存储为<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC#LanguageManualORC-HiveQLSyntax" target="_blank" rel="noopener noreferrer">ORC</a>文件格式。支持ACID事务和基于成本的优化器(CBO)。列式模式存储数据。</td></tr><tr><td style="text-align:left;">STORED AS PARQUET</td><td style="text-align:left;">存储为<a href="https://cwiki.apache.org/confluence/display/Hive/Parquet" target="_blank" rel="noopener noreferrer">Parquet</a>文件格式。<a href="https://cwiki.apache.org/confluence/display/Hive/Parquet#Parquet-Hive0.13andlater" target="_blank" rel="noopener noreferrer">Hive 0.13.0 </a>之后的版本支持。</td></tr><tr><td style="text-align:left;">STORED AS AVRO</td><td style="text-align:left;">存储为Avro文件格式。<a href="https://issues.apache.org/jira/browse/HIVE-6806" target="_blank" rel="noopener noreferrer">Hive 0.14.0 </a>之后的版本支持 (更多参阅<a href="https://cwiki.apache.org/confluence/display/Hive/AvroSerDe" target="_blank" rel="noopener noreferrer">Avro SerDe</a>)。</td></tr><tr><td style="text-align:left;">STORED AS RCFILE</td><td style="text-align:left;">存储为 <a href="https://en.wikipedia.org/wiki/RCFile" target="_blank" rel="noopener noreferrer">Record Columnar File</a> 文件格式。</td></tr><tr><td style="text-align:left;">STORED AS JSONFILE</td><td style="text-align:left;">存储为Json文件格式。Hive 4.0.0及以上版本支持</td></tr><tr><td style="text-align:left;">STORED BY</td><td style="text-align:left;">存储为<code>non-native table</code>格式。例如 <a href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration" target="_blank" rel="noopener noreferrer">HBase</a> 、<a href="https://cwiki.apache.org/confluence/display/Hive/Druid+Integration" target="_blank" rel="noopener noreferrer">Druid</a> 、<a href="https://cwiki.apache.org/confluence/display/Hive/AccumuloIntegration" target="_blank" rel="noopener noreferrer">Accumulo</a>。 (更多参阅<a href="https://cwiki.apache.org/confluence/display/Hive/StorageHandlers" target="_blank" rel="noopener noreferrer">StorageHandlers</a>）</td></tr><tr><td style="text-align:left;">INPUTFORMAT and OUTPUTFORMAT</td><td style="text-align:left;">在file_format中指定相应的InputFormat和OutputFormat类的名称。<br><br>例如, &#39;org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextInputFormat&#39;. <br><br>例如LZO压缩格式，可以设定为：<br>&#39;INPUTFORMAT &quot;com.hadoop.mapred.DeprecatedLzoTextInputFormat&quot; <br>OUTPUTFORMAT &quot;<a href="http://org.apache.hadoop.hive.ql.io/" target="_blank" rel="noopener noreferrer">org.apache.hadoop.hive.ql.io</a>.HiveIgnoreKeyTextOutputFormat&quot;&#39;</td></tr></tbody></table><h4 id="row-formats-serde" tabindex="-1"><a class="header-anchor" href="#row-formats-serde" aria-hidden="true">#</a> Row Formats &amp; SerDe</h4><p>用户可以通过自定义序列化类或使用Hive自带的序列化类创建表。如果未指定<code>ROW FORMAT</code>或<code>ROW FORMAT DELIMITED</code>，则使用默认的序列化格式。 使用<code>SERDE</code>创建带有自定义SerDe的表。关于SerDes的更多信息，请参阅：</p><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide#DeveloperGuide-HiveSerDe" target="_blank" rel="noopener noreferrer">Hive SerDe</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SerDe" target="_blank" rel="noopener noreferrer">SerDe</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/HCatalog+StorageFormats" target="_blank" rel="noopener noreferrer">HCatalog Storage Formats</a></li></ul><p>有关SerDes的更多信息，参阅开发指南中的<a href="https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide#DeveloperGuide-HiveSerDe" target="_blank" rel="noopener noreferrer">Hive SerDe</a>。</p><p>有关输入和输出处理的详细信息，参阅<a href="https://cwiki.apache.org/confluence/display/Hive/SerDe" target="_blank" rel="noopener noreferrer">SerDe</a>。</p><p>要更改表的SerDe或SERDEPROPERTIES，可参考使用本文Add SerDe Properties章节中所述的ALTER TABLE语句。</p><p><strong>RegEx</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 存储为纯文本文件，由正则表达式翻译。</span>
<span class="token keyword">ROW</span> FORMAT SERDE
<span class="token string">&#39;org.apache.hadoop.hive.serde2.RegexSerDe&#39;</span>
<span class="token keyword">WITH</span> SERDEPROPERTIES
<span class="token punctuation">(</span>
<span class="token string">&quot;input.regex&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;&lt;regex&gt;&quot;</span>
<span class="token punctuation">)</span>
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> apachelog <span class="token punctuation">(</span>
  host STRING<span class="token punctuation">,</span>
  <span class="token keyword">identity</span> STRING<span class="token punctuation">,</span>
  <span class="token keyword">user</span> STRING<span class="token punctuation">,</span>
  <span class="token keyword">time</span> STRING<span class="token punctuation">,</span>
  request STRING<span class="token punctuation">,</span>
  <span class="token keyword">status</span> STRING<span class="token punctuation">,</span>
  size STRING<span class="token punctuation">,</span>
  referer STRING<span class="token punctuation">,</span>
  agent STRING<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT SERDE <span class="token string">&#39;org.apache.hadoop.hive.serde2.RegexSerDe&#39;</span>
<span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span>
  <span class="token string">&quot;input.regex&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;([^]*) ([^]*) ([^]*) (-|\\[^\\]*\\]) ([^ \&quot;]*|\&quot;[^\&quot;]*\&quot;) (-|[0-9]*) (-|[0-9]*)(?: ([^ \&quot;]*|\&quot;.*\&quot;) ([^ \&quot;]*|\&quot;.*\&quot;))?&quot;</span>
<span class="token punctuation">)</span>
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>
</code></pre></div><p><strong>JSON</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 存储为JSON格式的纯文本文件</span>
<span class="token keyword">ROW</span> FORMAT SERDE
<span class="token string">&#39;org.apache.hive.hcatalog.data.JsonSerDe&#39;</span>
STORED <span class="token keyword">AS</span> TEXTFILE

<span class="token comment">-- JSON文件的JsonSerDe在Hive 0.12及以后版本中可用。</span>
<span class="token comment">-- 在某些发行版中，需要引用hive-hcatalog-core.jar</span>
<span class="token comment">-- ADD JAR /usr/lib/hive-hcatalog/lib/hive-hcatalog-core.jar;</span>

<span class="token comment">-- 实例</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> my_table<span class="token punctuation">(</span>a string<span class="token punctuation">,</span> b <span class="token keyword">bigint</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT SERDE <span class="token string">&#39;org.apache.hive.hcatalog.data.JsonSerDe&#39;</span>
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>

<span class="token comment">-- JsonSerDe从HCatalog移到Hive，在Hive-contrib项目之前。它是由Hive-4895添加到Hive发行版的。</span>
<span class="token comment">-- 对于0.12.0之前的版本，可以在s3://elasticmapreduce/samples/hive-ads/libs/jsonserde.jar找到Amazon SerDe。</span>

<span class="token comment">-- JSON文件的JsonSerDe在Hive 0.12及以后版本中可用。</span>
<span class="token comment">-- 从Hive 3.0.0开始，JsonSerDe以“org.apache.hadoop.hive.serde2”的形式添加到Hive Serde中（HIVE-19211)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> my_table<span class="token punctuation">(</span>a string<span class="token punctuation">,</span> b <span class="token keyword">bigint</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT SERDE <span class="token string">&#39;org.apache.hadoop.hive.serde2.JsonSerDe&#39;</span>
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>

<span class="token comment">-- 从Hive 4.0.0 (Hive -19899)开始支持STORED AS JSONFILE，因此可以创建如下表:</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> my_table<span class="token punctuation">(</span>a string<span class="token punctuation">,</span> b <span class="token keyword">bigint</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> STORED <span class="token keyword">AS</span> JSONFILE<span class="token punctuation">;</span>
</code></pre></div><p><strong>CSV/TSV</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- CSV/TSV格式纯文本文件</span>
<span class="token comment">-- CSVSerde在Hive 0.14及更高版本中可用。</span>
<span class="token keyword">ROW</span> FORMAT SERDE
<span class="token string">&#39;org.apache.hadoop.hive.serde2.OpenCSVSerde&#39;</span>
STORED <span class="token keyword">AS</span> TEXTFILE

<span class="token comment">-- 下面的示例创建一个TSV(制表符分隔)文件。</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> my_table<span class="token punctuation">(</span>
    a string<span class="token punctuation">,</span> 
    b string<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT SERDE <span class="token string">&#39;org.apache.hadoop.hive.serde2.OpenCSVSerde&#39;</span>
<span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span>
   <span class="token string">&quot;separatorChar&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;\t&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;quoteChar&quot;</span>     <span class="token operator">=</span> <span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;escapeChar&quot;</span>    <span class="token operator">=</span> <span class="token string">&quot;\\&quot;</span>
<span class="token punctuation">)</span>  
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>
</code></pre></div><h4 id="partitioned-tables" tabindex="-1"><a class="header-anchor" href="#partitioned-tables" aria-hidden="true">#</a> Partitioned Tables</h4><p>使用<code>Partitioned BY</code>创建的表称之为分区表。一个表可以有一个或多个分区列，分区列中的每个不同值组合都会创建一个单独的数据目录。</p><p>此外，可以使用<code>CLUSTERED BY</code>列对表或分区进行分桶，并且可以通过<code>SORT BY</code>对该分桶数据进行排序，用于提高某些查询的性能。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 分区表建表示例</span>
<span class="token comment">/*该语句创建了包含viewTime、userid、page_url、referrer_url和ip列(包括注释)的page_view表
  表也被分区，分区字段为dt、country
  数据存储格式为SEQUENCEFILE。并使用\001作为字段分隔符，用换行符作为行分隔符*/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> page_view<span class="token punctuation">(</span>
     viewTime <span class="token keyword">INT</span><span class="token punctuation">,</span> 
     userid <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
     page_url STRING<span class="token punctuation">,</span> 
     referrer_url STRING<span class="token punctuation">,</span>
     ip STRING <span class="token keyword">COMMENT</span> <span class="token string">&#39;IP Address of the User&#39;</span>
<span class="token punctuation">)</span>
<span class="token keyword">COMMENT</span> <span class="token string">&#39;This is the page view table&#39;</span>
PARTITIONED <span class="token keyword">BY</span><span class="token punctuation">(</span>dt STRING<span class="token punctuation">,</span> country STRING<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED
 <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;\001&#39;</span>
STORED <span class="token keyword">AS</span> SEQUENCEFILE<span class="token punctuation">;</span>
</code></pre></div><p>如果在创建分区表时，出现这样的错误：<code>FAILED: Error in semantic analysis: Column repeated in partitioning columns</code>，这意味着分区列和普通列出现了重复。需要修改分区列列名或普通列列名。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 列名与分区列名相同</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> table_name <span class="token punctuation">(</span>
  id                <span class="token keyword">int</span><span class="token punctuation">,</span>
  <span class="token keyword">date</span>              string<span class="token punctuation">,</span>
  name              string
<span class="token punctuation">)</span>
partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">date</span> string<span class="token punctuation">)</span>


<span class="token comment">-- 建议修改任意一方消除重复</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> table_name <span class="token punctuation">(</span>
  id                <span class="token keyword">int</span><span class="token punctuation">,</span>
  dtDontQuery       string<span class="token punctuation">,</span>
  name              string
<span class="token punctuation">)</span>
partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">date</span> string<span class="token punctuation">)</span>
</code></pre></div><h4 id="bucketed-sorted-tables" tabindex="-1"><a class="header-anchor" href="#bucketed-sorted-tables" aria-hidden="true">#</a> Bucketed Sorted Tables</h4><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- page_view表按用户id分桶，并且在每个bucket中，数据是按viewTime的递增顺序排序的。</span>
<span class="token comment">-- 这样的结构，方便用户对聚类列(userid)进行有效的抽样</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> page_view<span class="token punctuation">(</span>viewTime <span class="token keyword">INT</span><span class="token punctuation">,</span> userid <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
     page_url STRING<span class="token punctuation">,</span> referrer_url STRING<span class="token punctuation">,</span>
     ip STRING <span class="token keyword">COMMENT</span> <span class="token string">&#39;IP Address of the User&#39;</span><span class="token punctuation">)</span>
 <span class="token keyword">COMMENT</span> <span class="token string">&#39;This is the page view table&#39;</span>
 PARTITIONED <span class="token keyword">BY</span><span class="token punctuation">(</span>dt STRING<span class="token punctuation">,</span> country STRING<span class="token punctuation">)</span>
 <span class="token keyword">CLUSTERED</span> <span class="token keyword">BY</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span> SORTED <span class="token keyword">BY</span><span class="token punctuation">(</span>viewTime<span class="token punctuation">)</span> <span class="token keyword">INTO</span> <span class="token number">32</span> BUCKETS
 <span class="token keyword">ROW</span> FORMAT DELIMITED
   <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;\001&#39;</span>
   COLLECTION ITEMS <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;\002&#39;</span>
   MAP <span class="token keyword">KEYS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;\003&#39;</span>
 STORED <span class="token keyword">AS</span> SEQUENCEFILE<span class="token punctuation">;</span>
</code></pre></div><p><code>CLUSTERED BY</code>和<code>SORTED BY</code>创建命令不影响数据如何插入到表中，只影响如何读取数据。用户必须合理的插入相应的数据，使得<code>reducers</code>的数量等于桶的数量。并在查询中使用CLUSTER BY和SORT BY命令。</p><h4 id="external-tables" tabindex="-1"><a class="header-anchor" href="#external-tables" aria-hidden="true">#</a> External Tables</h4><p>在建表时如果使用了EXTERNAL关键字，那么该表就称之为外表，外表在创建时需要使用LOCATION来指定hdfs路径。当你删除这个外表时，hdfs中的数据并不会随之而删除。从Hive 4.0.0版本开始，提供了<code>external.table.purge=true</code>参数，该参数被设定为true时，当你删除外表时，其指定的hdfs路径下的文件也将被删除。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 你可以该语句创建一个page_view表，它可以指向任意一个HDFS的存储位置。但是仍然确保该路径下的数据时按照CREATE语句中指定的方式进行分隔。</span>
<span class="token keyword">CREATE</span> EXTERNAL <span class="token keyword">TABLE</span> page_view<span class="token punctuation">(</span>viewTime <span class="token keyword">INT</span><span class="token punctuation">,</span> userid <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
     page_url STRING<span class="token punctuation">,</span> referrer_url STRING<span class="token punctuation">,</span>
     ip STRING <span class="token keyword">COMMENT</span> <span class="token string">&#39;IP Address of the User&#39;</span><span class="token punctuation">,</span>
     country STRING <span class="token keyword">COMMENT</span> <span class="token string">&#39;country of origination&#39;</span><span class="token punctuation">)</span>
 <span class="token keyword">COMMENT</span> <span class="token string">&#39;This is the staging page view table&#39;</span>
 <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;\054&#39;</span>
 STORED <span class="token keyword">AS</span> TEXTFILE
 LOCATION <span class="token string">&#39;&lt;hdfs_location&gt;&#39;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="skewed-tables" tabindex="-1"><a class="header-anchor" href="#skewed-tables" aria-hidden="true">#</a> Skewed Tables</h4><p>当表中的一个或多个列具有倾斜值时，使用此特性有助于提高性能。通过指定经常出现的值(严重倾斜的值)，Hive会自动将这些值拆分到单独的文件（或目录下的列表桶），并在查询时考虑这一文件，避免扫描全表。可以在表创建期间在每个表级别上分别指定。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 下面的示例显示了一个具有三个倾斜值的列，可选择使用指定列表桶的STORED AS DIRECTORIES子句。</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> list_bucket_single <span class="token punctuation">(</span><span class="token keyword">key</span> STRING<span class="token punctuation">,</span> <span class="token keyword">value</span> STRING<span class="token punctuation">)</span>
  SKEWED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token keyword">key</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> DIRECTORIES<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 这是一个有两个倾斜列的表的例子。</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> list_bucket_multiple <span class="token punctuation">(</span>col1 STRING<span class="token punctuation">,</span> col2 <span class="token keyword">int</span><span class="token punctuation">,</span> col3 STRING<span class="token punctuation">)</span>
  SKEWED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&#39;s1&#39;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;s3&#39;</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;s13&#39;</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;s78&#39;</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> DIRECTORIES<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="temporary-tables" tabindex="-1"><a class="header-anchor" href="#temporary-tables" aria-hidden="true">#</a> Temporary Tables</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 1.1.0开始，临时表的存储策略可以通过<code>Hive.exec.temporary.table.storage</code>配置参数设置为memory、ssd或default(参见<a href="http://hadoop.apache.org/docs/r2.6.0/hadoop-project-dist/hadoop-hdfs/ArchivalStorage.html#Storage_Types_and_Storage_Policies" target="_blank" rel="noopener noreferrer">HDFS Storage Types and Storage Policies</a>)。</p></div><p><code>Temporary Table</code>创建的临时表仅对当前会话可见。数据存储在用户的临时目录中，并在会话结束时删除。</p><p>如果创建临时表时使用的数据库/表名是数据库中已经存在的永久表，那么在会话中对该表的任何引用都将解析为临时表，而不是永久表。如果不删除临时表或将其重命名为不冲突的名称，用户将无法在该会话中访问到原始表。</p><p>Temporary tables有以下一些限制：</p><ul><li>不支持分区列。</li><li>不支持创建索引。</li></ul><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> <span class="token keyword">TABLE</span> list_bucket_multiple <span class="token punctuation">(</span>col1 STRING<span class="token punctuation">,</span> col2 <span class="token keyword">int</span><span class="token punctuation">,</span> col3 STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="transactional-tables" tabindex="-1"><a class="header-anchor" href="#transactional-tables" aria-hidden="true">#</a> Transactional Tables</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 4.0开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-18453" target="_blank" rel="noopener noreferrer">HIVE-18453</a>).</p></div><p>支持ACID语义操作的表。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> TRANSACTIONAL <span class="token keyword">TABLE</span> transactional_table_test <span class="token punctuation">(</span>
    <span class="token keyword">key</span> string<span class="token punctuation">,</span> <span class="token keyword">value</span> string
<span class="token punctuation">)</span> 
PARTITIONED <span class="token keyword">BY</span><span class="token punctuation">(</span>ds string<span class="token punctuation">)</span>
STORED <span class="token keyword">AS</span> ORC<span class="token punctuation">;</span>
</code></pre></div><h4 id="create-table-as-select-ctas" tabindex="-1"><a class="header-anchor" href="#create-table-as-select-ctas" aria-hidden="true">#</a> Create Table As Select (CTAS)</h4><p>能够从一个表选择数据到另一个表是Hive最强大的特性之一。Hive在执行查询时处理数据从源格式到目标格式的转换。<code>create-table-as-select</code> (CTAS)语句是通过查询的结果创建表结果，并将查询的结果数据插入至创建的表中。由CTAS创建的表在查询执行完成之前，用户不会看到该表。</p><p>CTAS有以下一些限制：</p><ul><li>目标表不能是外表（External Tables）</li><li>目标表不能是分桶表（ Bucketed Sorted Tables）</li></ul><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- 用CTAS语句，从SELECT语句的结果(new_key DOUBLE, key_value_pair STRING)创建了目标表new_key_value_store。并在SELECT语句中使用特定的SerDe和独立于源表的存储格式创建新的目标表</span>
<span class="token comment">-- 注：如果SELECT语句没有指定列别名，列名将自动分配给_col0、_col1和_col2等。</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> new_key_value_store
   <span class="token keyword">ROW</span> FORMAT SERDE <span class="token string">&quot;org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe&quot;</span>
   STORED <span class="token keyword">AS</span> RCFile
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">key</span> <span class="token operator">%</span> <span class="token number">1024</span><span class="token punctuation">)</span> new_key<span class="token punctuation">,</span> concat<span class="token punctuation">(</span><span class="token keyword">key</span><span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">)</span> key_value_pair
<span class="token keyword">FROM</span> key_value_store
SORT <span class="token keyword">BY</span> new_key<span class="token punctuation">,</span> key_value_pair<span class="token punctuation">;</span>
</code></pre></div><h4 id="create-table-like" tabindex="-1"><a class="header-anchor" href="#create-table-like" aria-hidden="true">#</a> Create Table Like</h4><p><code>CREATE TABLE LIKE table_name</code>，可以复制现有表定义（不复制其数据）。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> empty_key_value_store
<span class="token operator">LIKE</span> key_value_store <span class="token punctuation">[</span>TBLPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>在Hive 0.8.0之前，<code>CREATE TABLE LIKE view_name</code>只是创建一个视图的副本。</p><p>在Hive 0.8.0及以后的版本中，<code>CREATE TABLE LIKE view_name</code>，可以通过view_name(字段和分区列)的模式创建一个表，使用默认的SerDe和文件格式。</p><h4 id="constraints" tabindex="-1"><a class="header-anchor" href="#constraints" aria-hidden="true">#</a> Constraints</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 2.1.0版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-13290" target="_blank" rel="noopener noreferrer">HIVE-13290</a>).</p></div><p>Hive支持主键和外键的设定。当存在约束时，一些SQL工具会生成更有效的查询。由于这些约束没有经过验证，所以上游系统需要在将数据加载到Hive之前确保数据的完整性。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> pk<span class="token punctuation">(</span>id1 <span class="token keyword">integer</span><span class="token punctuation">,</span> id2 <span class="token keyword">integer</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id1<span class="token punctuation">,</span> id2<span class="token punctuation">)</span> <span class="token keyword">disable</span> novalidate<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">create</span> <span class="token keyword">table</span> fk<span class="token punctuation">(</span>id1 <span class="token keyword">integer</span><span class="token punctuation">,</span> id2 <span class="token keyword">integer</span><span class="token punctuation">,</span>
  <span class="token keyword">constraint</span> c1 <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id1<span class="token punctuation">,</span> id2<span class="token punctuation">)</span> <span class="token keyword">references</span> pk<span class="token punctuation">(</span>id2<span class="token punctuation">,</span> id1<span class="token punctuation">)</span> <span class="token keyword">disable</span> novalidate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从Hive 3.0.0版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-16575" target="_blank" rel="noopener noreferrer">HIVE-16575</a>, <a href="https://issues.apache.org/jira/browse/HIVE-18726" target="_blank" rel="noopener noreferrer">HIVE-18726</a>, <a href="https://issues.apache.org/jira/browse/HIVE-18953" target="_blank" rel="noopener noreferrer">HIVE-18953</a>).</p></div><p>Hive支持在建表时使用UNIQUE, NOT NULL, DEFAULT和CHECK。除了UNIQUE之外，其他三种类型的约束都是强制的。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> constraints1 <span class="token punctuation">(</span>
    id1 <span class="token keyword">integer</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">disable</span> novalidate<span class="token punctuation">,</span> 
    id2 <span class="token keyword">integer</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    usr string <span class="token keyword">DEFAULT</span> <span class="token keyword">current_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    price <span class="token keyword">double</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>price <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">AND</span> price <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">create</span> <span class="token keyword">table</span> constraints2 <span class="token punctuation">(</span>
    id1 <span class="token keyword">integer</span><span class="token punctuation">,</span> 
    id2 <span class="token keyword">integer</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> c1_unique <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>id1<span class="token punctuation">)</span> <span class="token keyword">disable</span> novalidate
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">create</span> <span class="token keyword">table</span> constraints3 <span class="token punctuation">(</span>
    id1 <span class="token keyword">integer</span><span class="token punctuation">,</span> 
    id2 <span class="token keyword">integer</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> c1_check <span class="token keyword">CHECK</span><span class="token punctuation">(</span>id1 <span class="token operator">+</span> id2 <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>默认情况下，不支持复杂数据类型(如map、struct、array)。</p><h3 id="drop-table" tabindex="-1"><a class="header-anchor" href="#drop-table" aria-hidden="true">#</a> Drop Table</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> table_name <span class="token punctuation">[</span><span class="token keyword">PURGE</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment">-- (Note: PURGE available in Hive 0.14.0 and later)</span>
</code></pre></div><p><code>DROP TABLE</code>操作会删除表的元数据和数据。如果配置了Trash(并且没有指定PURGE)，删除表后数据会移动到.Trash/Current目录（一般情况下，数据会被移到用户主目录的.Trash下面）。否则，表信息将从metastore中删除，原始数据将被删除，就像使用<code>hadoop dfs -rm</code>一样。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">技巧提示</p><p>如果误删了表，可以通过重新创建一个相同模式的表，并重新创建分区，然后使用Hadoop命令手动将数据移回原位来恢复丢失的位置（这个解决方案可能会随着时间的推移变得无效，.Trash下的文件也是有保留时长，超时后会被彻底删除。所以强烈建议用户不要瞎吉尔删表。）</p></div><p>删除视图引用的表时，不会给出告警提示（在这之后对应的视图就无效了，必须由用户删除或重新创建）。</p><p>删除EXTERNAL表时，表中的数据不会删除。（从Hive 4.0.0版本开始，提供了<code>external.table.purge=true</code>参数，该参数被设定为true时，当你删除外表时，其指定的hdfs路径下的文件也将被删除。）</p><p>在Hive 0.7.0或更高版本中，如果删表时表已经不存在，DROP会返回一个错误提示，可以通过IF EXISTS子句或配置变量Hive .exec. DROP.ignorenonexistent被设置为true来跳过这个错误提示。</p><p>如果指定了PURGE，则表删除后，数据不会到. trash /Current目录，因此在错误的DROP事件中无法检索。清除选项也可以用表属性auto指定。清除(参见上面的TBLPROPERTIES)。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息: PURGE</p><p>从 Hive 0.14.0 开始支持(<a href="https://issues.apache.org/jira/browse/HIVE-7100" target="_blank" rel="noopener noreferrer">HIVE-7100</a>)PURGE 选项</p></div><h3 id="truncate-table" tabindex="-1"><a class="header-anchor" href="#truncate-table" aria-hidden="true">#</a> Truncate Table</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 0.11.0 版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-446" target="_blank" rel="noopener noreferrer">HIVE-446</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token punctuation">[</span><span class="token keyword">TABLE</span><span class="token punctuation">]</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
partition_spec:
  : <span class="token punctuation">(</span>partition_column <span class="token operator">=</span> partition_col_value<span class="token punctuation">,</span> partition_column <span class="token operator">=</span> partition_col_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p><code>Truncate Table</code>会删除表或分区中的所有数据内容，但不会清除表的元数据。如果文件系统垃圾回收模式是启用状态，这些行将被移入垃圾桶中（即.Trash目录），否则对应数据将被彻底删除(从Hive 2.2.0和Hive -14626开始)。用户可以使用<code>partition_spec</code>指定删除部分分区，若未指定则是删除整表。</p><p>从HIVE 2.3.0 (HIVE-15880)开始，如果表属性<code>auto.purge</code>(参见上面的TBLPROPERTIES)被设置为<code>true</code>，则当对表发出TRUNCATE table命令时，表的数据不会移动到Trash。这个属性只对内表有效。</p><p>从Hive 4.0 (Hive -23183)开始，TABLE这个关键字变的可选，但以前的版本执行TRUNCATE仍需要带上它。</p><h2 id="alter-table-partition-column" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-column" aria-hidden="true">#</a> Alter Table/Partition/Column</h2><p><code>Alter table</code>语句使用户能够更改现有表的结构。可以添加列/分区，更改SerDe，添加表和SerDe属性，或者重命名表本身等。类似地，<code>Alter table partition </code>语句允许更改指定表特定分区的属性。</p><h3 id="alter-table" tabindex="-1"><a class="header-anchor" href="#alter-table" aria-hidden="true">#</a> Alter Table</h3><h4 id="rename-table" tabindex="-1"><a class="header-anchor" href="#rename-table" aria-hidden="true">#</a> Rename Table</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> new_table_name<span class="token punctuation">;</span>
</code></pre></div><p>这个语句用于给表进行重命名。</p><p>在Hive0.6之前，该语句只是在metastore中重命名表，不移动HDFS位置。</p><p>从Hive0.6开始，该语句会对内表执行重命名，并会改变其数据文件的HDFS位置。</p><p>从Hive2.2.0版本(<a href="https://issues.apache.org/jira/browse/HIVE-14909" target="_blank" rel="noopener noreferrer">HIVE-14909</a>)开始，执行该语句的规则发生了变化，只有在创建表时不带LOCATION子句并且在其数据库目录下时，才会修改HDFS位置。</p><h4 id="alter-table-properties" tabindex="-1"><a class="header-anchor" href="#alter-table-properties" aria-hidden="true">#</a> Alter Table Properties</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">SET</span> TBLPROPERTIES table_properties<span class="token punctuation">;</span>
 
table_properties:
  : <span class="token punctuation">(</span>property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span>
</code></pre></div><p>此语用于给表追加其他属性。</p><p>目前，last_modified_user、last_modified_time属性由Hive自动添加和管理。用户可以将表的其他属性添加到此列表中。</p><p>可以使用DESCRIBE EXTENDED TABLE来获取所有表当前所有的属性信息。</p><h5 id="alter-table-comment" tabindex="-1"><a class="header-anchor" href="#alter-table-comment" aria-hidden="true">#</a> Alter Table Comment</h5><p>此语句通过修改表的属性来修改其注释。</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">SET</span> TBLPROPERTIES <span class="token punctuation">(</span><span class="token string">&#39;comment&#39;</span> <span class="token operator">=</span> new_comment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="add-serde-properties" tabindex="-1"><a class="header-anchor" href="#add-serde-properties" aria-hidden="true">#</a> Add SerDe Properties</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">SET</span> SERDE serde_class_name <span class="token punctuation">[</span><span class="token keyword">WITH</span> SERDEPROPERTIES serde_properties<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">SET</span> SERDEPROPERTIES serde_properties<span class="token punctuation">;</span>
 
serde_properties:
  : <span class="token punctuation">(</span>property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span>
</code></pre></div><p>这些语句用于更改表的SerDe或向表的SerDe对象添加用户定义的元数据。（注意，<code>property_name</code>和<code>property_value</code>都必须加引号。）</p><p>当Hive以序列化和反序列化初始化表时，SerDe属性会被传递。因此用户可以在这里存储自定义SerDe所需的信息。</p><p>Example:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">SET</span> SERDEPROPERTIES <span class="token punctuation">(</span><span class="token string">&#39;field.delim&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>更多信息请参考 <a href="https://cwiki.apache.org/confluence/display/Hive/SerDe" target="_blank" rel="noopener noreferrer">SerDe documentation</a> 和<a href="https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide#DeveloperGuide-HiveSerDe" target="_blank" rel="noopener noreferrer">Hive SerDe</a> 。</p><h4 id="remove-serde-properties" tabindex="-1"><a class="header-anchor" href="#remove-serde-properties" aria-hidden="true">#</a> Remove SerDe Properties</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 4.0.0 版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-18842" target="_blank" rel="noopener noreferrer">HIVE-21952</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> UNSET SERDEPROPERTIES <span class="token punctuation">(</span>property_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这些语句用于将用户定义的元数据删除。（注意，<code>property_name</code>必须加引号。）</p><p>Example:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name UNSET SERDEPROPERTIES <span class="token punctuation">(</span><span class="token string">&#39;field.delim&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="alter-table-storage-properties" tabindex="-1"><a class="header-anchor" href="#alter-table-storage-properties" aria-hidden="true">#</a> Alter Table Storage Properties</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">CLUSTERED</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>SORTED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">INTO</span> num_buckets BUCKETS<span class="token punctuation">;</span>
</code></pre></div><p>这些语句用于修改表的物理存储属性。</p><p>注意：这些命令只会修改Hive的元数据，不会重组或重新格式化现有的数据。用户应该确保实际的数据布局符合元数据定义。</p><h4 id="alter-table-skewed-or-stored-as-directories" tabindex="-1"><a class="header-anchor" href="#alter-table-skewed-or-stored-as-directories" aria-hidden="true">#</a> Alter Table Skewed or Stored as Directories</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 0.10.0 版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-3072" target="_blank" rel="noopener noreferrer">HIVE-3072</a> and <a href="https://issues.apache.org/jira/browse/HIVE-3649" target="_blank" rel="noopener noreferrer">HIVE-3649</a>).</p></div><p>可以使用ALTER table语句更改表的倾斜和存储AS目录选项。有关相应的CREATE TABLE语法，请参阅上方章节。</p><h5 id="alter-table-skewed" tabindex="-1"><a class="header-anchor" href="#alter-table-skewed" aria-hidden="true">#</a> Alter Table Skewed</h5><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name SKEWED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span> col_name2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
  <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>col_name1_value<span class="token punctuation">,</span> col_name2_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>col_name1_value<span class="token punctuation">,</span> col_name2_value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> DIRECTORIES<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>STORED AS DIRECTORIES选项决定倾斜表是否使用列表bucket特性，该特性为倾斜值创建子目录。</p><h5 id="alter-table-not-skewed" tabindex="-1"><a class="header-anchor" href="#alter-table-not-skewed" aria-hidden="true">#</a> Alter Table Not Skewed</h5><div class="language-text ext-text"><pre class="language-text"><code>ALTER TABLE table_name NOT SKEWED;
</code></pre></div><p><code>NOT incline</code>选项可以使表不启用倾斜选项，并关闭列表桶功能(因为列表桶表总是倾斜的)。这会影响ALTER语句之后创建的分区，但对ALTER语句之前创建的分区没有影响。</p><h5 id="alter-table-not-stored-as-directories" tabindex="-1"><a class="header-anchor" href="#alter-table-not-stored-as-directories" aria-hidden="true">#</a> Alter Table Not Stored as Directories</h5><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token operator">NOT</span> STORED <span class="token keyword">AS</span> DIRECTORIES<span class="token punctuation">;</span>
</code></pre></div><p>这将关闭列表桶功能，尽管表仍然倾斜。</p><h5 id="alter-table-set-skewed-location" tabindex="-1"><a class="header-anchor" href="#alter-table-set-skewed-location" aria-hidden="true">#</a> Alter Table Set Skewed Location</h5><div class="language-text ext-text"><pre class="language-text"><code>ALTER TABLE table_name SET SKEWED LOCATION (col_name1=&quot;location1&quot; [, col_name2=&quot;location2&quot;, ...] );
</code></pre></div><p>这将更改列表桶的位置映射。</p><h4 id="alter-table-constraints" tabindex="-1"><a class="header-anchor" href="#alter-table-constraints" aria-hidden="true">#</a> Alter Table Constraints</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 2.1.0 版本开始支持</p></div><p>可以通过ALTER Table语句添加或删除表约束。</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> table_name<span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE RELY<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">DISABLE</span> NOVALIDATE<span class="token punctuation">;</span>

<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name CHANGE <span class="token keyword">COLUMN</span> column_name column_name data_type <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">ENABLE</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name CHANGE <span class="token keyword">COLUMN</span> column_name column_name data_type <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">DEFAULT</span> default_value <span class="token keyword">ENABLE</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name CHANGE <span class="token keyword">COLUMN</span> column_name column_name data_type <span class="token keyword">CONSTRAINT</span> constraint_name <span class="token keyword">CHECK</span> check_expression <span class="token keyword">ENABLE</span><span class="token punctuation">;</span>
 
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">;</span>
</code></pre></div><h4 id="additional-alter-table-statements" tabindex="-1"><a class="header-anchor" href="#additional-alter-table-statements" aria-hidden="true">#</a> Additional Alter Table Statements</h4><p>有关更多更改表的DDL语句，请参见下面的Alter Either Table or Partition。</p><h3 id="alter-partition" tabindex="-1"><a class="header-anchor" href="#alter-partition" aria-hidden="true">#</a> Alter Partition</h3><p>通过使用ALTER TABLE语句中的PARTITION子句，可以添加、重命名、交换(移动)、删除或(是否)归档分区。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 1.2 版本开始 (<a href="https://issues.apache.org/jira/browse/HIVE-10307" target="_blank" rel="noopener noreferrer">HIVE-10307</a>), 如果属性<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.typecheck.on.insert" target="_blank" rel="noopener noreferrer">hive.typecheck.on.insert</a>被设置为true(默认值)，分区规范中指定的分区值将被类型检查、转换和规范化以符合其列类型。值可以是数字字面值。</p></div><h4 id="add-partitions" tabindex="-1"><a class="header-anchor" href="#add-partitions" aria-hidden="true">#</a> <strong>Add Partitions</strong></h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec <span class="token punctuation">[</span>LOCATION <span class="token string">&#39;location&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">PARTITION</span> partition_spec <span class="token punctuation">[</span>LOCATION <span class="token string">&#39;location&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
partition_spec:
  : <span class="token punctuation">(</span>partition_column <span class="token operator">=</span> partition_col_value<span class="token punctuation">,</span> partition_column <span class="token operator">=</span> partition_col_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p>可以使用ALTER TABLE ADD PARTITION为表添加分区。分区值只有在是字符串时才需要加引号。<code>LOCATION</code>必须是数据文件所在的目录。（<code>ADD PARTITION</code>改变了表元数据，但不加载数据。如果数据在分区的位置不存在，查询将不会返回任何结果。)如果该表的分区已经存在，则抛出一个错误。可以使用IF NOT EXISTS来跳过这个错误提醒。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>在Hive0.7版本中，一个ALTER TABLE中包含多个<code>partition_spec</code>这种写法会报错。</p><p>在Hive 0.8版本及以后版本中，可以在一条ALTER TABLE语句中添加多个分区，如下例所示。</p></div><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> page_view <span class="token keyword">ADD</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">&#39;2008-08-08&#39;</span><span class="token punctuation">,</span> country<span class="token operator">=</span><span class="token string">&#39;us&#39;</span><span class="token punctuation">)</span> location <span class="token string">&#39;/path/to/us/part080808&#39;</span>
                          <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">&#39;2008-08-09&#39;</span><span class="token punctuation">,</span> country<span class="token operator">=</span><span class="token string">&#39;us&#39;</span><span class="token punctuation">)</span> location <span class="token string">&#39;/path/to/us/part080809&#39;</span><span class="token punctuation">;</span>
</code></pre></div><p>在Hive 0.7中，如果想添加很多分区，应该使用下面的形式：</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partCol <span class="token operator">=</span> <span class="token string">&#39;value1&#39;</span><span class="token punctuation">)</span> location <span class="token string">&#39;loc1&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partCol <span class="token operator">=</span> <span class="token string">&#39;value2&#39;</span><span class="token punctuation">)</span> location <span class="token string">&#39;loc2&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partCol <span class="token operator">=</span> <span class="token string">&#39;valueN&#39;</span><span class="token punctuation">)</span> location <span class="token string">&#39;locN&#39;</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="dynamic-partitions" tabindex="-1"><a class="header-anchor" href="#dynamic-partitions" aria-hidden="true">#</a> <strong>Dynamic Partitions</strong></h5><p>在执行Hive INSERT语句(或Pig STORE语句)时，动态添加分区。有关细节和示例，请参阅这些文档:</p><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/DynamicPartitions" target="_blank" rel="noopener noreferrer">Design Document for Dynamic Partitions</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/Tutorial#Tutorial-Dynamic-PartitionInsert" target="_blank" rel="noopener noreferrer">Tutorial: Dynamic-Partition Insert</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-DynamicPartitionInserts" target="_blank" rel="noopener noreferrer">Hive DML: Dynamic Partition Inserts</a></li><li>HCatalog Dynamic Partitioning <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/HCatalog+DynamicPartitions#HCatalogDynamicPartitions-UsagewithPig" target="_blank" rel="noopener noreferrer">Usage with Pig</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/HCatalog+DynamicPartitions#HCatalogDynamicPartitions-UsagefromMapReduce" target="_blank" rel="noopener noreferrer">Usage from MapReduce</a></li></ul></li></ul><h4 id="rename-partition" tabindex="-1"><a class="header-anchor" href="#rename-partition" aria-hidden="true">#</a> Rename Partition</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 0.9. 版本开始支持</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">PARTITION</span> partition_spec <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">;</span>
</code></pre></div><p>这个语句会更改分区列的值。通常情况下的用例是，可以使用此语句来规范化遗留分区的列值，使其符合规范类型。在这种情况下，旧partition_spec中的列值没有启用类型转换和归一化，即使属性hive.typecheck.on.insert设置为true(默认)，仍旧可以在旧partition_spec中以字符串形式查看指定遗留数据。</p><h4 id="exchange-partition" tabindex="-1"><a class="header-anchor" href="#exchange-partition" aria-hidden="true">#</a> Exchange Partition</h4><p>在表之间交换(移动)分区。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 0.12 版本开始支持(<a href="https://issues.apache.org/jira/browse/HIVE-4095" target="_blank" rel="noopener noreferrer">HIVE-4095</a>). 支持多分区的版本：Hive <a href="https://issues.apache.org/jira/browse/HIVE-11745" target="_blank" rel="noopener noreferrer">1.2.2, 1.3.0, and 2.0.0+</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- Move partition from table_name_1 to table_name_2</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name_2 EXCHANGE <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_spec<span class="token punctuation">)</span> <span class="token keyword">WITH</span> <span class="token keyword">TABLE</span> table_name_1<span class="token punctuation">;</span>
<span class="token comment">-- multiple partitions</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name_2 EXCHANGE <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_spec<span class="token punctuation">,</span> partition_spec2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">WITH</span> <span class="token keyword">TABLE</span> table_name_1<span class="token punctuation">;</span>
</code></pre></div><p>该语句允许将分区中的数据从一个表移动到另一个具有相同模式且尚未拥有该分区的表。</p><h4 id="discover-partitions" tabindex="-1"><a class="header-anchor" href="#discover-partitions" aria-hidden="true">#</a> Discover Partitions</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>从 Hive 4.0.0 版本开始支持 (<a href="https://issues.apache.org/jira/browse/HIVE-20707" target="_blank" rel="noopener noreferrer">HIVE-20707</a>).</p></div><p><code>discover.partitions</code>是一个表属性 ，该属性用于令Hive Metastore启动分区元数据的自动发现和同步。</p><p>当 Hive Metastore Service (HMS) 在远程服务模式下启动时，后台线程(PartitionManagementTask)每300秒定时调度一次(可通过Metastore .partition.management.task.frequency config配置)，它查找带有<code>discover. partition.management.task.frequency config</code>的表。<code>partitions</code>表属性设置为true并在同步模式下执行<code>MSCK REPAIR</code>。如果表是事务性表，则在执行<code>MSCK REPAIR</code>之前为该表获得<code>Exclusive Lock</code>。有了这个表属性，<code>MSCK REPAIR table table_name SYNC PARTITIONS</code>不再需要手动运行。</p><h4 id="partition-retention" tabindex="-1"><a class="header-anchor" href="#partition-retention" aria-hidden="true">#</a> Partition Retention</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 4.0.0 (<a href="https://issues.apache.org/jira/browse/HIVE-20707" target="_blank" rel="noopener noreferrer">HIVE-20707</a>).</p></div><p>表属性<code>partition.retention</code>，可以为分区表指定保留周期。当指定保留间隔时，运行在HMS中的后台线程(请参阅“发现分区”部分)将检查分区的年龄(创建时间)，如果分区的年龄大于保留时间，则将删除分区，同时也会删除该分区中的数据。</p><p>例如，如果一张以<code>date</code>为分区列的表，在创建时启用了<code>&quot;discover.partitions&quot;=&quot;true&quot;</code>并设置了<code>&quot;partition.retention.period&quot;=&quot;7d&quot;</code>。则仅保留最近7天内创建的分区，7前天的数据将被定时清理。</p><h4 id="recover-partitions-msck-repair-table" tabindex="-1"><a class="header-anchor" href="#recover-partitions-msck-repair-table" aria-hidden="true">#</a> Recover Partitions (MSCK REPAIR TABLE)</h4><p>Hive在其元数据库中为每个表存储一个分区列表。然而，如果新分区被直接添加到HDFS(例如使用hadoop fs -put命令)或从HDFS删除，除非用户在每个新添加或删除的分区上分别运行<code>ALTER TABLE table_name ADD/DROP partition</code>命令，否则metastore(因此Hive)不会意识到这些对分区信息的更改。</p><p>但是，用户可以使用repair table选项运行metastore check命令:</p><div class="language-sql ext-sql"><pre class="language-sql"><code>MSCK <span class="token punctuation">[</span>REPAIR<span class="token punctuation">]</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">ADD</span><span class="token operator">/</span><span class="token keyword">DROP</span><span class="token operator">/</span>SYNC PARTITIONS<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>它会将元数据不存在的分区更新到Hive的元数据库。MSC命令的默认选项是ADD PARTITIONS</p><ul><li>ADD PARTITIONS选项，将HDFS上存在但不在元数据库中的分区添加到元数据库中。</li><li>DROP PARTITIONS选项，将从元数据库中删除分区信息，这已经从HDFS中删除了。</li><li>SYNC PARTITIONS选项，等同于同时调用ADD PARTITIONS和DROP PARTITIONS。</li><li>See <a href="https://issues.apache.org/jira/browse/HIVE-874" target="_blank" rel="noopener noreferrer">HIVE-874</a> and <a href="https://issues.apache.org/jira/browse/HIVE-17824" target="_blank" rel="noopener noreferrer">HIVE-17824</a> for more details.</li><li>当Hive中存在大量未跟踪的分区时，可以通过批处理运行MSCK REPAIR TABLE来避免OOME(Out of Memory Error)。配置<code>hive.msck.repair.batch.size</code>的大小，该属性的默认值为0，这意味着它将一次执行所有分区。</li><li>MSCK命令如果不添加 REPAIR选项，可用于修复与元数据库中不匹配的元数据。</li></ul><p>在<code>Amazon Elastic MapReduce (EMR)</code>的Hive版本上的等效命令是：</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name RECOVER PARTITIONS<span class="token punctuation">;</span>
</code></pre></div><p>从Hive 1.3开始，如果在HDFS上发现分区值中包含不允许字符的目录，MSCK将抛出异常。可以通过<code>hive.msck.path.validation</code>属性设置来改变这种行为：</p><ul><li><code>skip</code>：将跳过目录</li><li><code>ignore</code>：将尝试创建分区(旧行为)，这可能有用，也可能没用。</li></ul><h4 id="drop-partitions" tabindex="-1"><a class="header-anchor" href="#drop-partitions" aria-hidden="true">#</a> Drop Partitions</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">IGNORE</span> PROTECTION<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">PURGE</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token comment">-- (Note: PURGE available in Hive 1.2.0 and later, IGNORE PROTECTION not available 2.0.0 and later)</span>
</code></pre></div><p>可以使用<code>ALTER TABLE DROP PARTITION</code>删除一个表的分区。这将删除该分区的数据和元数据。如果配置了Trash，数据会移动到.Trash/Current目录，除非指定了PURGE，但是无论如何，元数据都会完全丢失(参见上面的Drop Table)。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息: PROTECTION</p><p>IGNORE PROTECTION is no longer available in versions 2.0.0 and later. This functionality is replaced by using one of the several security options available with Hive (see <a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization" target="_blank" rel="noopener noreferrer">SQL Standard Based Hive Authorization</a>). See <a href="https://issues.apache.org/jira/browse/HIVE-11145" target="_blank" rel="noopener noreferrer">HIVE-11145</a> for details.</p></div><p>对于NO_DROP CASCADE保护的表，可以使用IGNORE PROTECTION删除指定的分区或一组分区(例如，在两个Hadoop集群之间分割一个表时):</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec <span class="token keyword">IGNORE</span> PROTECTION<span class="token punctuation">;</span>
</code></pre></div><p>不管保护状态如何，上面的命令都将删除该分区。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息: PURGE</p><p>The PURGE option is added to ALTER TABLE in version 1.2.1 by <a href="https://issues.apache.org/jira/browse/HIVE-10934" target="_blank" rel="noopener noreferrer">HIVE-10934</a>.</p></div><p>如果指定了PURGE，分区数据不会到.Trash/Current目录，因此在DROP的事件日志中无法检索到错误信息：</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec <span class="token keyword">PURGE</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 1.2.0 and later)</span>
</code></pre></div><p>清除选项也可以用表属性<code>auto.purge</code>。(参见上面的TBLPROPERTIES)。</p><p>在Hive 0.7.0或更高版本中，如果删除的分区不存在，DROP时将返回一个错误，除非指定了if EXISTS或配置变量 <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.drop.ignorenonexistent" target="_blank" rel="noopener noreferrer">hive.exec.drop.ignorenonexistent</a>被设置为true。</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> page_view <span class="token keyword">DROP</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">&#39;2008-08-08&#39;</span><span class="token punctuation">,</span> country<span class="token operator">=</span><span class="token string">&#39;us&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="un-archive-partition" tabindex="-1"><a class="header-anchor" href="#un-archive-partition" aria-hidden="true">#</a> (Un)Archive Partition</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name ARCHIVE <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name UNARCHIVE <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">;</span>
</code></pre></div><p>归档是一种将分区文件移动到Hadoop Archive (HAR)的功能。注意，只有文件计数会减少;HAR不提供任何压缩。参阅<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Archiving" target="_blank" rel="noopener noreferrer">LanguageManual Archiving</a>获取更多详情。</p><h3 id="alter-either-table-or-partition" tabindex="-1"><a class="header-anchor" href="#alter-either-table-or-partition" aria-hidden="true">#</a> Alter Either Table or Partition</h3><h4 id="alter-table-partition-file-format" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-file-format" aria-hidden="true">#</a> Alter Table/Partition File Format</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">SET</span> FILEFORMAT file_format<span class="token punctuation">;</span>
</code></pre></div><p>此语句更改表(或分区)的文件格式。有关可用的file_format选项，请参阅上面CREATE TABLE的部分。该操作仅更改表元数据。现有数据的任何转换都必须在Hive外部完成。</p><h4 id="alter-table-partition-location" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-location" aria-hidden="true">#</a> Alter Table/Partition Location</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">SET</span> LOCATION <span class="token string">&quot;new location&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="alter-table-partition-touch" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-touch" aria-hidden="true">#</a> Alter Table/Partition Touch</h4><div class="language-text ext-text"><pre class="language-text"><code>ALTER TABLE table_name TOUCH [PARTITION partition_spec];
</code></pre></div><p>TOUCH读取元数据，并重写（修改表的<code>LastModifiedTime</code>，并将表的<code>LastModifiedTime</code>修改为当前时间）。举个例子，假如你有一个hooks （它将记录所有被修改的表/分区），以及一个外部脚本（可以直接改变HDFS上的文件）。由于脚本在hive外部修改文件，因此hooks 不会记录修改。外部脚本可以调用TOUCH来触发hooks ，并将所述表或分区标记为已修改。</p><p>注意，TOUCH命令不会创建表或分区如果它们不存在的话。</p><h4 id="alter-table-partition-protections" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-protections" aria-hidden="true">#</a> Alter Table/Partition Protections</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.7.0 (<a href="https://issues.apache.org/jira/browse/HIVE-1413" target="_blank" rel="noopener noreferrer">HIVE-1413</a>). The CASCADE clause for NO_DROP was added in HIVE 0.8.0 (<a href="https://issues.apache.org/jira/browse/HIVE-2605" target="_blank" rel="noopener noreferrer">HIVE-2605</a>).</p><p>This functionality was removed in Hive 2.0.0. This functionality is replaced by using one of the several security options available with Hive (see <a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization" target="_blank" rel="noopener noreferrer">SQL Standard Based Hive Authorization</a>). See <a href="https://issues.apache.org/jira/browse/HIVE-11145" target="_blank" rel="noopener noreferrer">HIVE-11145</a> for details.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">ENABLE</span><span class="token operator">|</span><span class="token keyword">DISABLE</span> NO_DROP <span class="token punctuation">[</span><span class="token keyword">CASCADE</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token keyword">ENABLE</span><span class="token operator">|</span><span class="token keyword">DISABLE</span> OFFLINE<span class="token punctuation">;</span>
</code></pre></div><p>数据保护可以设置在表级或分区级。启用NO_DROP可以防止表被删除。启用OFFLINE可以阻止查询表或分区中的数据，但仍然可以访问元数据。</p><p>如果表中的任何分区启用了NO_DROP，则表也不能被删除。相反，如果一个表启用了NO/+DROP，那么分区可以被删除，但是如果使用NO_DROP，级联分区也不能被删除，除非drop partition命令指定了IGNORE PROTECTION。</p><h4 id="alter-table-partition-compact" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-compact" aria-hidden="true">#</a> Alter Table/Partition Compact</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>In Hive release <a href="https://issues.apache.org/jira/browse/HIVE-5317" target="_blank" rel="noopener noreferrer">0.13.0</a> and later when <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">transactions</a> are being used, the ALTER TABLE statement can request <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-BasicDesign" target="_blank" rel="noopener noreferrer">compaction</a> of a table or partition. As of Hive release <a href="https://issues.apache.org/jira/browse/HIVE-13354" target="_blank" rel="noopener noreferrer">1.3.0 and 2.1.0</a> when <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">transactions</a> are being used, the ALTER TABLE ... COMPACT statement can include a <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties" target="_blank" rel="noopener noreferrer">TBLPROPERTIES</a> clause that is either to change compaction MapReduce job properties or to overwrite any other Hive table properties. More details can be found <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties" target="_blank" rel="noopener noreferrer">here</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_key <span class="token operator">=</span> <span class="token string">&#39;partition_value&#39;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  COMPACT <span class="token string">&#39;compaction_type&#39;</span><span class="token punctuation">[</span><span class="token operator">AND</span> WAIT<span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">WITH</span> OVERWRITE TBLPROPERTIES <span class="token punctuation">(</span><span class="token string">&quot;property&quot;</span><span class="token operator">=</span><span class="token string">&quot;value&quot;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>一般来说，当使用<a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">Hive transactions</a>时，不需要手动合并文件，因为系统将自动检测并自动合并。但是，如果关闭了表的自动合并，或者您希望不通过系统执行自动合并，那么可以使用ALTER table来操作合并事项。默认情况下，该语句将对压缩请求进行排队并返回。要查看合并的进度，使用<code>SHOW COMPACTIONS</code>。从Hive 2.2.0开始，加入了<code>AND WAIT</code>可选项，该项用于指定在合并执行完成之前的一些操作。</p><p>合并类型可以时 MAJOR 或是 MINOR。 参阅 <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-BasicDesign" target="_blank" rel="noopener noreferrer">Hive Transactions</a> 获取更多详情。</p><h4 id="alter-table-partition-concatenate" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-concatenate" aria-hidden="true">#</a> Alter Table/Partition Concatenate</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>In Hive release <a href="https://issues.apache.org/jira/browse/HIVE-1950" target="_blank" rel="noopener noreferrer">0.8.0</a> RCFile added support for fast block level merging of small RCFiles using concatenate command. In Hive release <a href="https://issues.apache.org/jira/browse/HIVE-7509" target="_blank" rel="noopener noreferrer">0.14.0</a> ORC files added support fast stripe level merging of small ORC files using concatenate command.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_key <span class="token operator">=</span> <span class="token string">&#39;partition_value&#39;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> CONCATENATE<span class="token punctuation">;</span>
</code></pre></div><p>如果表或分区包含许多小的rcfile或ORC文件，那么上面的命令将把它们合并成更大的文件。对于RCFile，合并发生在块级别，而对于ORC文件，合并发生在条带级别，从而避免了解压和解码数据的开销。</p><h4 id="alter-table-partition-update-columns" tabindex="-1"><a class="header-anchor" href="#alter-table-partition-update-columns" aria-hidden="true">#</a> Alter Table/Partition Update columns</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>In Hive release <a href="https://issues.apache.org/jira/browse/HIVE-15995" target="_blank" rel="noopener noreferrer">3.0.0</a> this command was added to let the user sync serde stored schema information to metastore.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_key <span class="token operator">=</span> <span class="token string">&#39;partition_value&#39;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">UPDATE</span> <span class="token keyword">COLUMNS</span><span class="token punctuation">;</span>
</code></pre></div><p>具有serdes的表(serdes自描述表模式)在使用中可能与存储在Hive Metastore中的表具有不同的模式。例如，当用户使用模式url或模式文字创建一个Avro存储表时，该模式将被插入到HMS中，然后无论serde中的url或文字是否更改，该模式都不会在HMS中更改。这可能会导致问题，特别是在与其他Apache组件集成时。</p><p>更新列特性为用户提供了一种方法，可以让serde中所做的更改同步到HMS中。它同时适用于表和分区级别，但只适用于HMS没有跟踪模式的表(参见metastore.serdes.using.metastore.for.schema)。对后一种serde类型使用该命令将导致错误。</p><h3 id="alter-column" tabindex="-1"><a class="header-anchor" href="#alter-column" aria-hidden="true">#</a> Alter Column</h3><h4 id="rules-for-column-names" tabindex="-1"><a class="header-anchor" href="#rules-for-column-names" aria-hidden="true">#</a> Rules for Column Names</h4><p>列名不区分大小写。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">**版本信息**</p><p>在Hive 0.12及更早的版本中，表名和列名中只允许使用字母数字和下划线字符。</p><p>在Hive 0.13及以后的版本中，列名可以包含任何Unicode字符(参见Hive -6013)，但是，点(.)和冒号(:)在查询时会产生错误，因此在Hive 1.2.0中不允许使用它们(参见Hive -10120)。如果在表名或列名中使用到了特殊字符或保留关键字，可以使用反撇号包裹，使其可以被强制定义。</p><p>如果想要恢复到Hive 0.13之前，即将列名限制为只允许字母数字和下划线字符，请将配置属性<code>hive.support.quotes.identifiers=none</code>。启用该配置后，反撇号包含的内容将被解释为正则表达式。有关更多详细信息，请参见<a href="https://issues.apache.org/jira/secure/attachment/12618321/QuotedIdentifier.html" target="_blank" rel="noopener noreferrer">Supporting Quoted Identifiers in Column Names</a>。</p></div><h4 id="change-column-name-type-position-comment" tabindex="-1"><a class="header-anchor" href="#change-column-name-type-position-comment" aria-hidden="true">#</a> Change Column Name/Type/Position/Comment</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> CHANGE <span class="token punctuation">[</span><span class="token keyword">COLUMN</span><span class="token punctuation">]</span> col_old_name col_new_name column_type
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">FIRST</span><span class="token operator">|</span><span class="token keyword">AFTER</span> column_name<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">CASCADE</span><span class="token operator">|</span><span class="token keyword">RESTRICT</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>此命令允许用户更改列名、数据类型、注释或位置，或它们的组合。PARTITION子句在Hive 0.14.0及更高版本中可用。使用方法请参见 <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types#LanguageManualTypes-UpgradingPre-Hive0.13.0DecimalColumns" target="_blank" rel="noopener noreferrer">Upgrading Pre-Hive 0.13.0 Decimal Columns</a> 。Hive 0.13的补丁也可用(参见<a href="https://issues.apache.org/jira/browse/HIVE-7971" target="_blank" rel="noopener noreferrer">HIVE-7971</a>)。</p><p>Hive 1.1.0中添加了CASCADE|RESTRICT子句。<code>ALTER TABLE CHANGE COLUMN with CASCADE</code>命令更改列同时更新表的元数据，并将相同的更改级联到所有分区元数据。<code>RESTRICT</code>是ALTER Column的默认值，仅更新列的元数据。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">TIP</p><p>无论表或分区的保护模式如何，ALTER TABLE CHANGE COLUMN CASCADE子句都将覆盖表分区的列元数据。谨慎使用。</p></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">TIP</p><p>列更改命令只会修改Hive的元数据，而不会修改数据。用户应该确保表/分区的实际数据布局符合元数据定义。</p></div><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_change <span class="token punctuation">(</span>a <span class="token keyword">int</span><span class="token punctuation">,</span> b <span class="token keyword">int</span><span class="token punctuation">,</span> c <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// First change column a&#39;s name to a1.</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test_change CHANGE a a1 <span class="token keyword">INT</span><span class="token punctuation">;</span>
 
<span class="token comment">// Next change column a1&#39;s name to a2, its data type to string, and put it after column b.</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test_change CHANGE a1 a2 STRING <span class="token keyword">AFTER</span> b<span class="token punctuation">;</span>
<span class="token comment">// The new table&#39;s structure is:  b int, a2 string, c int.</span>
  
<span class="token comment">// Then change column c&#39;s name to c1, and put it as the first column.</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test_change CHANGE c c1 <span class="token keyword">INT</span> <span class="token keyword">FIRST</span><span class="token punctuation">;</span>
<span class="token comment">// The new table&#39;s structure is:  c1 int, b int, a2 string.</span>
  
<span class="token comment">// Add a comment to column a1</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test_change CHANGE a1 a1 <span class="token keyword">INT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;this is column a1&#39;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="add-replace-columns" tabindex="-1"><a class="header-anchor" href="#add-replace-columns" aria-hidden="true">#</a> Add/Replace Columns</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name 
  <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span>                 <span class="token comment">-- (Note: Hive 0.14.0 and later)</span>
  <span class="token keyword">ADD</span><span class="token operator">|</span><span class="token keyword">REPLACE</span> <span class="token keyword">COLUMNS</span> <span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
  <span class="token punctuation">[</span><span class="token keyword">CASCADE</span><span class="token operator">|</span><span class="token keyword">RESTRICT</span><span class="token punctuation">]</span>                         <span class="token comment">-- (Note: Hive 1.1.0 and later)</span>
</code></pre></div><p><code>ADD COLUMNS</code>，会将新列添加到现有列的末尾，但在分区列之前。<code>ADD COLUMNS</code>这也Avro类型的表，这需要Hive 0.14和更高版本。</p><p><code>REPLACE COLUMNS</code>，该选项会删除所有现有列并添加新列集。这只能用于具有本地SerDe的表(DynamicSerDe, MetadataTypedColumnsetSerDe, LazySimpleSerDe和ColumnarSerDe)。更多信息请参考Hive SerDe。REPLACE COLUMNS也可以用来删除列。例如，<code>ALTER TABLE test_change REPLACE COLUMNS (a int, b int);</code>将从test_change表中删除列&#39;c&#39;。</p><p>PARTITION子句在Hive 0.14.0及更高版本中可用。使用方法请参见 <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types#LanguageManualTypes-UpgradingPre-Hive0.13.0DecimalColumns" target="_blank" rel="noopener noreferrer">Upgrading Pre-Hive 0.13.0 Decimal Columns</a></p><p>Hive 1.1.0中添加了CASCADE|RESTRICT子句。<code>ALTER TABLE ADD|REPLACE COLUMNS with CASCADE</code>命令更改列同时更新表的元数据，并将相同的更改级联到所有分区元数据。<code>RESTRICT</code>是ALTER Column的默认值，仅更新列的元数据。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">TIP</p><p>无论表或分区的保护模式如何，ALTER TABLE ADD or REPLACE COLUMNS CASCAD子句都将覆盖表分区的列元数据。谨慎使用。</p></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">TIP</p><p>列更改命令只会修改Hive的元数据，而不会修改数据。用户应该确保表/分区的实际数据布局符合元数据定义。</p></div><h4 id="partial-partition-specification" tabindex="-1"><a class="header-anchor" href="#partial-partition-specification" aria-hidden="true">#</a> Partial Partition Specification</h4><p>从Hive 0.14 (Hive -8411)开始，alter语句类似于动态分区的操作。因此，不必为每个需要更改的分区发出alter column语句:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> foo <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2008-04-08&#39;</span><span class="token punctuation">,</span> hr<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span> CHANGE <span class="token keyword">COLUMN</span> dec_column_name dec_column_name <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> foo <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2008-04-08&#39;</span><span class="token punctuation">,</span> hr<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span> CHANGE <span class="token keyword">COLUMN</span> dec_column_name dec_column_name <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>．.． 你可以使用ALTER语句一次更改多个现有分区:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">// hive.exec.dynamic.partition needs to be set to true to enable dynamic partitioning with ALTER PARTITION</span>
<span class="token keyword">SET</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  
<span class="token comment">// This will alter all existing partitions in the table with ds=&#39;2008-04-08&#39; -- be sure you know what you are doing!</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> foo <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2008-04-08&#39;</span><span class="token punctuation">,</span> hr<span class="token punctuation">)</span> CHANGE <span class="token keyword">COLUMN</span> dec_column_name dec_column_name <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// This will alter all existing partitions in the table -- be sure you know what you are doing!</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> foo <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>ds<span class="token punctuation">,</span> hr<span class="token punctuation">)</span> CHANGE <span class="token keyword">COLUMN</span> dec_column_name dec_column_name <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>与动态分区类似，<code>hive.exec.dynamic.partition</code>必须设置为<code>true</code>，以便在ALTER partition期间使用部分分区规范。支持如下操作：</p><ul><li>Change column</li><li>Add column</li><li>Replace column</li><li>File Format</li><li>Serde Properties</li></ul><h2 id="create-drop-alter-view" tabindex="-1"><a class="header-anchor" href="#create-drop-alter-view" aria-hidden="true">#</a> Create/Drop/Alter View</h2><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateView" target="_blank" rel="noopener noreferrer">Create View</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DropView" target="_blank" rel="noopener noreferrer">Drop View</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AlterViewProperties" target="_blank" rel="noopener noreferrer">Alter View Properties</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AlterViewAsSelect" target="_blank" rel="noopener noreferrer">Alter View As Select</a></li></ul><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>View support is only available in Hive 0.6 and later.</p></div><h3 id="create-view" tabindex="-1"><a class="header-anchor" href="#create-view" aria-hidden="true">#</a> Create View</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>view_name <span class="token punctuation">[</span><span class="token punctuation">(</span>column_name <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> column_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> view_comment<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>TBLPROPERTIES <span class="token punctuation">(</span>property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><p><code>CREATE VIEW</code> 创建给定名称的视图。如果已经存在同名的表或视图，则抛出异常。可以使用IF NOT EXISTS来跳过这个错误。</p><p>如果没有定义列名，视图的列名将从定义SELECT表达式中自动创建（如果SELECT包含无别名的表达式，例如x+y，则生成的视图列名将以_C0、_C1等形式生成)。当重命名列时，还可以选择提供列注释（注释不会自动从底层列继承）。</p><p>如果视图定义的SELECT表达式无效，CREATE VIEW语句同样会执行失败。</p><p>注意，视图是一个没有关联存储的纯逻辑对象。当查询引用视图时，将计算视图的定义，以便生成一组行供查询进一步处理。(这是一个概念性的描述；事实上，作为查询优化的一部分，Hive可能会将视图的定义与查询的定义结合起来，例如，从查询向下推过滤器到视图中。)</p><p>视图的模式在创建视图时就已经被锁定；对底层表的后续更改(例如添加一个列)将不会反映在视图的模式中。如果以不兼容的方式删除或更改底层表，后续查询无效视图的尝试将失败。</p><p>视图是只读的，不能用作LOAD/INSERT/ALTER的目标。要更改视图的元数据，请参见<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AlterViewProperties" target="_blank" rel="noopener noreferrer">ALTER VIEW</a>。</p><p>视图可以包含ORDER BY和LIMIT子句。但是创建的使用这些优先级将高于后续查询时的语法。例如，如果一个视图在创建时指定了LIMIT 5，在查询阶段执行(select * from v LIMIT 10)，那么也最多返回5行。</p><p>从<a href="https://issues.apache.org/jira/browse/HIVE-1180" target="_blank" rel="noopener noreferrer">Hive 0.13.0</a>开始，视图的select语句可以包括一个或多个通用表表达式(CTEs)，如<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Select#LanguageManualSelect-SelectSyntax" target="_blank" rel="noopener noreferrer">select语法</a>所示。有关CREATE VIEW语句中的cte示例，请参见<a href="https://cwiki.apache.org/confluence/display/Hive/Common+Table+Expression#CommonTableExpression-CTEinViews,CTAS,andInsertStatements" target="_blank" rel="noopener noreferrer">通用表表达式</a>。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> onion_referrers<span class="token punctuation">(</span>url <span class="token keyword">COMMENT</span> <span class="token string">&#39;URL of Referring page&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">COMMENT</span> <span class="token string">&#39;Referrers to The Onion website&#39;</span>
  <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> referrer_url
  <span class="token keyword">FROM</span> page_view
  <span class="token keyword">WHERE</span> page_url<span class="token operator">=</span><span class="token string">&#39;http://www.theonion.com&#39;</span><span class="token punctuation">;</span>
</code></pre></div><p>使用<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowCreateTable" target="_blank" rel="noopener noreferrer">SHOW CREATE TABLE</a>，显示创建视图的CREATE VIEW语句。</p><p>使用<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowViews" target="_blank" rel="noopener noreferrer">SHOW VIEWS</a>，显示数据库中的视图列表（从Hive 2.2.0开始）。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>Originally, the file format for views was hard coded as SequenceFile. Hive 2.1.0 (<a href="https://issues.apache.org/jira/browse/HIVE-13736" target="_blank" rel="noopener noreferrer">HIVE-13736</a>) made views follow the same defaults as tables and indexes using the <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.default.fileformat" target="_blank" rel="noopener noreferrer">hive.default.fileformat </a>and <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.default.fileformat.managed" target="_blank" rel="noopener noreferrer">hive.default.fileformat.managed</a> properties.</p></div><h3 id="drop-view" tabindex="-1"><a class="header-anchor" href="#drop-view" aria-hidden="true">#</a> Drop View</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>view_name<span class="token punctuation">;</span>
</code></pre></div><p><code>DROP VIEW</code>删除指定视图的元数据。(在视图上使用DROP TABLE是不可行的，会抛出异常。)</p><p>当删除由其他视图引用的视图时，不会给出警告。(依赖的视图悬空为无效，必须由用户删除或重新创建)。</p><p>在Hive 0.7.0或更高版本中，如果视图不存在，DROP将返回一个错误，除非指定if EXISTS或配置变量<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.drop.ignorenonexistent" target="_blank" rel="noopener noreferrer">hive.exec.drop.ignorenonexistent</a>为true。</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> onion_referrers<span class="token punctuation">;</span>
</code></pre></div><h3 id="alter-view-properties" tabindex="-1"><a class="header-anchor" href="#alter-view-properties" aria-hidden="true">#</a> Alter View Properties</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>view_name <span class="token keyword">SET</span> TBLPROPERTIES table_properties<span class="token punctuation">;</span>
 
table_properties:
  : <span class="token punctuation">(</span>property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><p>与ALTER TABLE一样，可以使用此语句向视图添加或修改元数据。</p><h3 id="alter-view-as-select" tabindex="-1"><a class="header-anchor" href="#alter-view-as-select" aria-hidden="true">#</a> Alter View As Select</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-3834" target="_blank" rel="noopener noreferrer">Hive 0.11</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>view_name <span class="token keyword">AS</span> select_statement<span class="token punctuation">;</span>
</code></pre></div><p>Alter View As Select changes the definition of a view, which must exist. The syntax is similar to that for CREATE VIEW and the effect is the same as for CREATE OR REPLACE VIEW.</p><p><code>Alter View As Select</code>用于更改已存在的视图的定义。语法与CREATE VIEW类似，效果与CREATE OR REPLACE VIEW相同。</p><p>注意：视图必须已经存在，如果视图有分区，它不能被Alter view As Select替换。</p><h2 id="create-drop-alter-materialized-view" tabindex="-1"><a class="header-anchor" href="#create-drop-alter-materialized-view" aria-hidden="true">#</a> Create/Drop/Alter Materialized View</h2><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateMaterializedView" target="_blank" rel="noopener noreferrer">Create Materialized View</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DropMaterializedView" target="_blank" rel="noopener noreferrer">Drop Materialized View</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AlterMaterializedView" target="_blank" rel="noopener noreferrer">Alter Materialized View</a></li></ul><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>Materialized view support is only available in Hive 3.0 and later.</p></div><p>本节介绍Hive物化视图语法。关于Hive中物化视图支持和使用的更多信息可以在这里<a href="https://cwiki.apache.org/confluence/display/Hive/Materialized+views" target="_blank" rel="noopener noreferrer">here</a>.找到。</p><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Indexing" target="_blank" rel="noopener noreferrer">Overview of Hive Indexes</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/IndexDev" target="_blank" rel="noopener noreferrer">Indexes design document</a></li></ul><p>在Hive 0.12.0和更早的版本中，CREATE index和DROP index语句的索引名是区分大小写的。然而，ALTER INDEX需要一个用小写字母创建的索引名(参见<a href="https://issues.apache.org/jira/browse/HIVE-2752" target="_blank" rel="noopener noreferrer">HIVE-2752</a>)。此错误在<a href="https://issues.apache.org/jira/browse/HIVE-2752" target="_blank" rel="noopener noreferrer">Hive 0.13.0</a>中修复，使所有HiveQL语句的索引名不区分大小写。对于0.13.0之前的版本，最佳实践是对所有索引名使用小写字母。</p><h3 id="create-index" tabindex="-1"><a class="header-anchor" href="#create-index" aria-hidden="true">#</a> Create Index</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
  <span class="token keyword">ON</span> <span class="token keyword">TABLE</span> base_table_name <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
  <span class="token keyword">AS</span> index_type
  <span class="token punctuation">[</span><span class="token keyword">WITH</span> DEFERRED REBUILD<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>IDXPROPERTIES <span class="token punctuation">(</span>property_name<span class="token operator">=</span>property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token operator">IN</span> <span class="token keyword">TABLE</span> index_table_name<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>
     <span class="token punctuation">[</span> <span class="token keyword">ROW</span> FORMAT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> STORED <span class="token keyword">AS</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     <span class="token operator">|</span> STORED <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">]</span>
  <span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span>
  <span class="token punctuation">[</span>TBLPROPERTIES <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> <span class="token string">&quot;index comment&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>CREATE INDEX</code>使用给定的列列表作为键在表上创建索引。参见<a href="https://cwiki.apache.org/confluence/display/Hive/IndexDev#IndexDev-CREATEINDEX" target="_blank" rel="noopener noreferrer">Indexes</a>设计文档中的CREATE INDEX。</p><h3 id="drop-index" tabindex="-1"><a class="header-anchor" href="#drop-index" aria-hidden="true">#</a> Drop Index</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>
</code></pre></div><p>DROP INDEX删除索引，同时删除索引表。</p><p>在Hive 0.7.0或更高版本中，如果索引不存在，DROP将抛出异常，除非指定if EXISTS或配置变量<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.drop.ignorenonexistent" target="_blank" rel="noopener noreferrer">Hive .exec. DROP .ignorenonexistent</a>设置为true。</p><h3 id="alter-index" tabindex="-1"><a class="header-anchor" href="#alter-index" aria-hidden="true">#</a> Alter Index</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> REBUILD<span class="token punctuation">;</span>
</code></pre></div><p>ALTER INDEX ... REBUILD builds an index that was created using the WITH DEFERRED REBUILD clause, or rebuilds a previously built index. If PARTITION is specified, only that partition is rebuilt.</p><p><code>ALTER INDEX ... REBUILD</code>构建使用<code>WITH DEFERRED REBUILD</code>子句创建的索引，或者重建先前构建的索引。如果指定了PARTITION，则只重建该分区。</p><h2 id="create-drop-macro" tabindex="-1"><a class="header-anchor" href="#create-drop-macro" aria-hidden="true">#</a> Create/Drop Macro</h2><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-2655" target="_blank" rel="noopener noreferrer">Hive 0.12.0.</a></p><p>Bug fixes:</p><ul><li>Prior to <a href="https://issues.apache.org/jira/browse/HIVE-11432" target="_blank" rel="noopener noreferrer">Hive 1.3.0 and 2.0.0</a> when a HiveQL macro was used more than once while processing the same row, Hive returned the same result for all invocations even though the arguments were different. (See <a href="https://issues.apache.org/jira/browse/HIVE-11432" target="_blank" rel="noopener noreferrer">HIVE-11432</a>.)</li><li>Prior to <a href="https://issues.apache.org/jira/browse/HIVE-12277" target="_blank" rel="noopener noreferrer">Hive 1.3.0 and 2.0.0</a> when multiple macros were used while processing the same row, an ORDER BY clause could give wrong results. (See <a href="https://issues.apache.org/jira/browse/HIVE-12277" target="_blank" rel="noopener noreferrer">HIVE-12277</a>.)</li><li>Prior to <a href="https://issues.apache.org/jira/browse/HIVE-13372" target="_blank" rel="noopener noreferrer">Hive 2.1.0</a> when multiple macros were used while processing the same row, results of the later macros were overwritten by that of the first. (See <a href="https://issues.apache.org/jira/browse/HIVE-13372" target="_blank" rel="noopener noreferrer">HIVE-13372</a>.)</li></ul></div><p>Hive 0.12.0向HiveQL引入了宏的概念，在此之前，宏只能在Java中创建。</p><h3 id="create-temporary-macro" tabindex="-1"><a class="header-anchor" href="#create-temporary-macro" aria-hidden="true">#</a> Create Temporary Macro</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> MACRO macro_name<span class="token punctuation">(</span><span class="token punctuation">[</span>col_name col_type<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span> expression<span class="token punctuation">;</span>
</code></pre></div><p>CREATE TEMPORARY MACRO creates a macro using the given optional list of columns as inputs to the expression. Macros exist for the duration of the current session.</p><p><code>CREATE TEMPORARY MACRO</code>使用给定的可选列列表作为表达式的输入创建一个宏。宏仅在当前会话期间存在。</p><p><strong>Examples:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> MACRO fixed_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> MACRO string_len_plus_two<span class="token punctuation">(</span>x string<span class="token punctuation">)</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TEMPORARY</span> MACRO simple_add <span class="token punctuation">(</span>x <span class="token keyword">int</span><span class="token punctuation">,</span> y <span class="token keyword">int</span><span class="token punctuation">)</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
</code></pre></div><h3 id="drop-temporary-macro" tabindex="-1"><a class="header-anchor" href="#drop-temporary-macro" aria-hidden="true">#</a> Drop Temporary Macro</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TEMPORARY</span> MACRO <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> macro_name<span class="token punctuation">;</span>
</code></pre></div><p>如果函数不存在，DROP TEMPORARY MACRO将返回一个错误，除非指定了if EXISTS。</p><h2 id="create-drop-reload-function" tabindex="-1"><a class="header-anchor" href="#create-drop-reload-function" aria-hidden="true">#</a> Create/Drop/Reload Function</h2><h3 id="temporary-functions" tabindex="-1"><a class="header-anchor" href="#temporary-functions" aria-hidden="true">#</a> Temporary Functions</h3><h4 id="create-temporary-function" tabindex="-1"><a class="header-anchor" href="#create-temporary-function" aria-hidden="true">#</a> Create Temporary Function</h4><div class="language-text ext-text"><pre class="language-text"><code>CREATE TEMPORARY FUNCTION function_name AS class_name;
</code></pre></div><p>该语句允许您创建一个由class_name实现的临时函数。只要会话持续，就可以在Hive查询中使用此功能。您可以使用Hive的类路径中的任何类。可以通过执行&#39;add JAR&#39;语句将JAR添加到类路径。请参考CLI部分<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveInteractiveShellCommands" target="_blank" rel="noopener noreferrer">Hive Interactive Shell Commands</a>,，包括<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources" target="_blank" rel="noopener noreferrer">Hive Resources</a>，了解更多信息。也可以参见<a href="https://cwiki.apache.org/confluence/display/Hive/HivePlugins" target="_blank" rel="noopener noreferrer">Hive Plugins</a>了解关于创建自定义udf的一般信息。</p><h4 id="drop-temporary-function" tabindex="-1"><a class="header-anchor" href="#drop-temporary-function" aria-hidden="true">#</a> Drop Temporary Function</h4><p>可以按以下方法删除注销UDF：</p><div class="language-text ext-text"><pre class="language-text"><code>DROP TEMPORARY FUNCTION [IF EXISTS] function_name;
</code></pre></div><p>在Hive 0.7.0或更高版本中，如果函数不存在，DROP将返回一个错误，除非指定if EXISTS或配置变量<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.drop.ignorenonexistent" target="_blank" rel="noopener noreferrer">hive.exec.drop.ignorenonexistent</a> 被设置为true。</p><h3 id="permanent-functions" tabindex="-1"><a class="header-anchor" href="#permanent-functions" aria-hidden="true">#</a> Permanent Functions</h3><p>在Hive 0.13或更高版本中，函数可以注册到metastore，这样查询中就可以引用它们，而不必在每个会话中创建一个临时函数。</p><h4 id="create-function" tabindex="-1"><a class="header-anchor" href="#create-function" aria-hidden="true">#</a> Create Function</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.13.0 (<a href="https://issues.apache.org/jira/browse/HIVE-6047" target="_blank" rel="noopener noreferrer">HIVE-6047</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>function_name <span class="token keyword">AS</span> class_name
  <span class="token punctuation">[</span><span class="token keyword">USING</span> JAR<span class="token operator">|</span><span class="token keyword">FILE</span><span class="token operator">|</span>ARCHIVE <span class="token string">&#39;file_uri&#39;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> JAR<span class="token operator">|</span><span class="token keyword">FILE</span><span class="token operator">|</span>ARCHIVE <span class="token string">&#39;file_uri&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>该语句用于创建一个由class_name实现的函数。需要添加到环境中的jar、文件或存档可以用USING子句指定；当函数第一次被Hive会话引用时，这些资源将被添加到环境中，就像<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources" target="_blank" rel="noopener noreferrer">ADD JAR/FILE</a>已经发布一样。如果Hive不在本地模式，则资源位置必须是非本地路径，例如HDFS位置。</p><p>函数将被添加到指定的数据库中，或者添加到创建函数时的当前数据库中。函数可以通过限定函数名(db_name.function_name)来引用，如果函数在当前数据库中，也可以不加限定直接引用。</p><h4 id="drop-function" tabindex="-1"><a class="header-anchor" href="#drop-function" aria-hidden="true">#</a> Drop Function</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.13.0 (<a href="https://issues.apache.org/jira/browse/HIVE-6047" target="_blank" rel="noopener noreferrer">HIVE-6047</a>).</p></div><div class="language-text ext-text"><pre class="language-text"><code>DROP FUNCTION [IF EXISTS] function_name;
</code></pre></div><p>如果函数不存在，DROP返回一个错误，除非指定了if EXISTS或者配置变量<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.exec.drop.ignorenonexistent" target="_blank" rel="noopener noreferrer">hive.exec.drop.ignorenonexistent</a>被设置为true。</p><h4 id="reload-function" tabindex="-1"><a class="header-anchor" href="#reload-function" aria-hidden="true">#</a> Reload Function</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 1.2.0 (<a href="https://issues.apache.org/jira/browse/HIVE-2573" target="_blank" rel="noopener noreferrer">HIVE-2573</a>).</p></div><div class="language-text ext-text"><pre class="language-text"><code>RELOAD (FUNCTIONS|FUNCTION);
</code></pre></div><p>在<a href="https://issues.apache.org/jira/browse/HIVE-2573" target="_blank" rel="noopener noreferrer">Hive -2573</a>之前，在某一个Hive CLI的会话中创建永久函数可能不会反映在HiveServer2或其他Hive CLI会话中（如果它们在函数创建之前启动）。在HiveServer2或HiveCLI会话中发出RELOAD函数将重新扫描对函数的更改（这些更改可能是由不同的HiveCLI会话完成的）。</p><h2 id="create-drop-grant-revoke-roles-and-privileges" tabindex="-1"><a class="header-anchor" href="#create-drop-grant-revoke-roles-and-privileges" aria-hidden="true">#</a> Create/Drop/Grant/Revoke Roles and Privileges</h2><p><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173" target="_blank" rel="noopener noreferrer">Hive deprecated authorization mode / Legacy Mode</a> has information about these DDL statements:</p><ul><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Create/DropRole" target="_blank" rel="noopener noreferrer">CREATE ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Grant/RevokeRoles" target="_blank" rel="noopener noreferrer">GRANT ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Grant/RevokeRoles" target="_blank" rel="noopener noreferrer">REVOKE ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Grant/RevokePrivileges" target="_blank" rel="noopener noreferrer">GRANT privilege_type</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Grant/RevokePrivileges" target="_blank" rel="noopener noreferrer">REVOKE privilege_type</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-Create/DropRole" target="_blank" rel="noopener noreferrer">DROP ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-ViewingGrantedRoles" target="_blank" rel="noopener noreferrer">SHOW ROLE GRANT</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-ViewingGrantedPrivileges" target="_blank" rel="noopener noreferrer">SHOW GRANT</a></li></ul><p>For <a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization" target="_blank" rel="noopener noreferrer">SQL standard based authorization </a>in Hive 0.13.0 and later releases, see these DDL statements:</p><ul><li>Role Management Commands <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-CreateRole" target="_blank" rel="noopener noreferrer">CREATE ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-GrantRole" target="_blank" rel="noopener noreferrer">GRANT ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-RevokeRole" target="_blank" rel="noopener noreferrer">REVOKE ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-DropRole" target="_blank" rel="noopener noreferrer">DROP ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowRoles" target="_blank" rel="noopener noreferrer">SHOW ROLES</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowRoleGrant" target="_blank" rel="noopener noreferrer">SHOW ROLE GRANT</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowCurrentRoles" target="_blank" rel="noopener noreferrer">SHOW CURRENT ROLES</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-SetRole" target="_blank" rel="noopener noreferrer">SET ROLE</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowPrincipals" target="_blank" rel="noopener noreferrer">SHOW PRINCIPALS</a></li></ul></li><li>Object Privilege Commands <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-Grant" target="_blank" rel="noopener noreferrer">GRANT privilege_type</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-Revoke" target="_blank" rel="noopener noreferrer">REVOKE privilege_type</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowGrant" target="_blank" rel="noopener noreferrer">SHOW GRANT</a></li></ul></li></ul><h2 id="show" tabindex="-1"><a class="header-anchor" href="#show" aria-hidden="true">#</a> Show</h2><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowDatabases" target="_blank" rel="noopener noreferrer">Show Databases</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowConnectors" target="_blank" rel="noopener noreferrer">Show Connectors</a></li><li>Show Tables/Views/Materialized Views/Partitions/Indexes <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowTables" target="_blank" rel="noopener noreferrer">Show Tables</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowViews" target="_blank" rel="noopener noreferrer">Show Views</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowMaterializedViews" target="_blank" rel="noopener noreferrer">Show Materialized Views</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowPartitions" target="_blank" rel="noopener noreferrer">Show Partitions</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowTable/PartitionExtended" target="_blank" rel="noopener noreferrer">Show Table/Partition Extended</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowTableProperties" target="_blank" rel="noopener noreferrer">Show Table Properties</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowCreateTable" target="_blank" rel="noopener noreferrer">Show Create Table</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowIndexes" target="_blank" rel="noopener noreferrer">Show Indexes</a></li></ul></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowColumns" target="_blank" rel="noopener noreferrer">Show Columns</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowFunctions" target="_blank" rel="noopener noreferrer">Show Functions</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowGrantedRolesandPrivileges" target="_blank" rel="noopener noreferrer">Show Granted Roles and Privileges</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowLocks" target="_blank" rel="noopener noreferrer">Show Locks</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowConf" target="_blank" rel="noopener noreferrer">Show Conf</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowTransactions" target="_blank" rel="noopener noreferrer">Show Transactions</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowCompactions" target="_blank" rel="noopener noreferrer">Show Compactions</a></li></ul><p>SHOW语句用于查询Hive metastore，以获取Hive的现有数据和元数据。</p><h3 id="show-databases" tabindex="-1"><a class="header-anchor" href="#show-databases" aria-hidden="true">#</a> Show Databases</h3><div class="language-text ext-text"><pre class="language-text"><code>SHOW (DATABASES|SCHEMAS) [LIKE &#39;identifier_with_wildcards&#39;];
</code></pre></div><p>使用<code>SHOW DATABASES</code>或<code>SHOW SCHEMAS</code>可以列出在metastore中定义的所有数据库。schema和databases的使用是可以互换的——它们的意思是一样的。</p><p>可选使用LIKE子句，可以用正则表达式筛选满足条件的数据库列表。正则表达式中的通配符只能为星号(*)或是竖线(|)。例如&#39;employees&#39;， &#39;emp*&#39;， &#39;emp*|*ees&#39;，这些都将匹配名为&#39;employees&#39;的数据库。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息: SHOW DATABASES</p><p>从hive 4.0.0开始只接收sql类型的通配符，&#39;%&#39; 用于表示任意字符, &#39;_&#39;用于表示单一字符. 例如：&#39;employees&#39;, &#39;emp%&#39;, &#39;emplo_ees&#39;, 这些都将匹配名为&#39;employees&#39;的数据库。</p></div><h3 id="show-connectors" tabindex="-1"><a class="header-anchor" href="#show-connectors" aria-hidden="true">#</a> Show Connectors</h3><div class="language-text ext-text"><pre class="language-text"><code>SHOW CONNECTORS;
</code></pre></div><p>从Hive 4.0.0 via <a href="https://issues.apache.org/jira/browse/HIVE-24396" target="_blank" rel="noopener noreferrer">HIVE-24396</a>版本可用。</p><p><code>SHOW CONNECTORS</code>列出在metastore中定义的所有连接器(取决于用户的访问权限)。</p><h3 id="show-tables-views-materialized-views-partitions-indexes" tabindex="-1"><a class="header-anchor" href="#show-tables-views-materialized-views-partitions-indexes" aria-hidden="true">#</a> Show Tables/Views/Materialized Views/Partitions/Indexes</h3><h4 id="show-tables" tabindex="-1"><a class="header-anchor" href="#show-tables" aria-hidden="true">#</a> Show Tables</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span> <span class="token punctuation">[</span><span class="token operator">IN</span> database_name<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token string">&#39;identifier_with_wildcards&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW TABLES</code>列出当前数据库（或使用&#39; in &#39;子句选中的数据库）中名称与可选正则表达式匹配的所有表和视图。正则表达式中的通配符只能为“*”，只能为“|”。例如&#39;page_view&#39;，&#39;page_v*&#39;，&#39;*view|page*&#39;，所有这些都将匹配&#39;page_view&#39;表。匹配的表将按字母顺序列出。如果在metastore中没有找到匹配的表，也不会报错。</p><h4 id="show-views" tabindex="-1"><a class="header-anchor" href="#show-views" aria-hidden="true">#</a> Show Views</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>Introduced in Hive 2.2.0 via <a href="https://issues.apache.org/jira/browse/HIVE-14558" target="_blank" rel="noopener noreferrer">HIVE-14558</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VIEWS <span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">/</span><span class="token keyword">FROM</span> database_name<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">LIKE</span> <span class="token string">&#39;pattern_with_wildcards&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW VIEWS</code> 列出当前数据库中所有名称与可选正则表达式匹配的视图(或使用&#39; in &#39;或&#39; FROM &#39;子句显式命名的视图)。正则表达式中的通配符只能为“*”，只能为“|”。例如&#39;page_view&#39;， &#39;page_v*&#39;， &#39;*view|page*&#39;，所有这些都将匹配&#39;page_view&#39;视图。匹配的视图按字母顺序列出。如果在metastore中没有找到匹配的视图，也不会报错。</p><p><strong>Examples</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VIEWS<span class="token punctuation">;</span>                                <span class="token comment">-- show all views in the current database</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token string">&#39;test_*&#39;</span><span class="token punctuation">;</span>                       <span class="token comment">-- show all views that start with &quot;test_&quot;</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token string">&#39;*view2&#39;</span><span class="token punctuation">;</span>                       <span class="token comment">-- show all views that end in &quot;view2&quot;</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token operator">LIKE</span> <span class="token string">&#39;test_view1|test_view2&#39;</span><span class="token punctuation">;</span>   <span class="token comment">-- show views named either &quot;test_view1&quot; or &quot;test_view2&quot;</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token keyword">FROM</span> test1<span class="token punctuation">;</span>                     <span class="token comment">-- show views from database test1</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token operator">IN</span> test1<span class="token punctuation">;</span>                       <span class="token comment">-- show views from database test1 (FROM and IN are same)</span>
<span class="token keyword">SHOW</span> VIEWS <span class="token operator">IN</span> test1 <span class="token string">&quot;test_*&quot;</span><span class="token punctuation">;</span>              <span class="token comment">-- show views from database test2 that start with &quot;test_&quot;</span>
</code></pre></div><h4 id="show-materialized-views" tabindex="-1"><a class="header-anchor" href="#show-materialized-views" aria-hidden="true">#</a> Show Materialized Views</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> MATERIALIZED VIEWS <span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">/</span><span class="token keyword">FROM</span> database_name<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">LIKE</span> &#39;pattern_with_wildcards’<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW MATERIALIZED VIEWS</code> 列出当前数据库中所有名称与可选正则表达式匹配的视图(或使用&#39; in &#39;或&#39; FROM &#39;子句显式命名的视图)。它还显示了关于物化视图的附加信息，例如，是否启用了重写，以及物化视图的刷新模式。正则表达式中的通配符只能为“*”，只能为“|”。如果没有给出正则表达式，则列出所选数据库中的所有物化视图。</p><h4 id="show-partitions" tabindex="-1"><a class="header-anchor" href="#show-partitions" aria-hidden="true">#</a> Show Partitions</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS table_name<span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW PARTITIONS</code>列出给定表的所有现有分区。分区按字母顺序列出。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.6, SHOW PARTITIONS can filter the list of partitions as shown below.</p><p>It is also possible to specify parts of a partition specification to filter the resulting list.</p></div><p><strong>Examples:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS table_name <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">-- (Note: Hive 0.6 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS table_name <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>hr<span class="token operator">=</span><span class="token string">&#39;12&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">-- (Note: Hive 0.6 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS table_name <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">,</span> hr<span class="token operator">=</span><span class="token string">&#39;12&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 0.6 and later)</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>Starting with Hive 0.13.0, SHOW PARTITIONS can specify a database (<a href="https://issues.apache.org/jira/browse/HIVE-5912" target="_blank" rel="noopener noreferrer">HIVE-5912</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span><span class="token punctuation">(</span>partition_spec<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 0.13.0 and later)</span>
</code></pre></div><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">,</span> hr<span class="token operator">=</span><span class="token string">&#39;12&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 0.13.0 and later)</span>
</code></pre></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>Starting with Hive 4.0.0, SHOW PARTITIONS can optionally use the WHERE/ORDER BY/LIMIT clause to filter/order/limit the resulting list (<a href="https://issues.apache.org/jira/browse/HIVE-22458" target="_blank" rel="noopener noreferrer">HIVE-22458</a>). These clauses work in a similar way as they do in a SELECT statement.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span><span class="token punctuation">(</span>partition_spec<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> where_condition<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> col_list<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">LIMIT</span> <span class="token keyword">rows</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
</code></pre></div><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>                                                               <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>                                    <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> hr <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>                   <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> hr <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> hr <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
<span class="token keyword">SHOW</span> PARTITIONS databaseFoo<span class="token punctuation">.</span>tableBar <span class="token keyword">WHERE</span> hr <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">AND</span> ds<span class="token operator">=</span><span class="token string">&#39;2010-03-03&#39;</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> hr <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>           <span class="token comment">-- (Note: Hive 4.0.0 and later)</span>
</code></pre></div><p>注意：请使用<em>hr &gt;= 10</em>而不是<em>hr - 10 &gt;= 0</em>来过滤结果，因为Metastore不会将后一个谓词下推到底层存储中</p><h4 id="show-table-partition-extended" tabindex="-1"><a class="header-anchor" href="#show-table-partition-extended" aria-hidden="true">#</a> Show Table/Partition Extended</h4><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">EXTENDED</span> <span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">FROM</span> database_name<span class="token punctuation">]</span> <span class="token operator">LIKE</span> <span class="token string">&#39;identifier_with_wildcards&#39;</span> <span class="token punctuation">[</span><span class="token keyword">PARTITION</span><span class="token punctuation">(</span>partition_spec<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW TABLE EXTENDED</code>将列出所有匹配给定正则表达式的表的信息。如果存在分区说明，则用户不能使用正则表达式作为表名。该命令的输出包括基本表信息和文件系统信息，如totalNumberFiles、totalFileSize、maxFileSize、minFileSize、lastAccessTime和lastUpdateTime。如果存在分区，它将输出给定分区的文件系统信息，而不是表的文件系统信息。</p><p><strong>Example</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code>hive<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">table</span> <span class="token keyword">extended</span> <span class="token operator">like</span> part_table<span class="token punctuation">;</span>
OK
tableName:part_table
owner:thejas
location:<span class="token keyword">file</span>:<span class="token operator">/</span>tmp<span class="token operator">/</span>warehouse<span class="token operator">/</span>part_table
inputformat:org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>TextInputFormat
outputformat:org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>io<span class="token punctuation">.</span>HiveIgnoreKeyTextOutputFormat
<span class="token keyword">columns</span>:struct <span class="token keyword">columns</span> { i32 i}
partitioned:<span class="token boolean">true</span>
partitionColumns:struct partition_columns { string d}
totalNumberFiles:<span class="token number">1</span>
totalFileSize:<span class="token number">2</span>
maxFileSize:<span class="token number">2</span>
minFileSize:<span class="token number">2</span>
lastAccessTime:<span class="token number">0</span>
lastUpdateTime:<span class="token number">1459382233000</span>
</code></pre></div><h4 id="show-table-properties" tabindex="-1"><a class="header-anchor" href="#show-table-properties" aria-hidden="true">#</a> Show Table Properties</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.10.0.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> TBLPROPERTIES tblname<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> TBLPROPERTIES tblname<span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>第一种形式列出了相关表的所有表属性，每行一个，由制表符分隔。</p><p>第二种形式仅打印正在请求的属性的值。</p><p>有关更多信息，请参阅上面Create Table中的<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-listTableProperties" target="_blank" rel="noopener noreferrer">TBLPROPERTIES clause</a>。</p><h4 id="show-create-table" tabindex="-1"><a class="header-anchor" href="#show-create-table" aria-hidden="true">#</a> Show Create Table</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-967" target="_blank" rel="noopener noreferrer">Hive 0.10</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name<span class="token operator">|</span>view_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW CREATE TABLE</code>显示给定表的CREATE TABLE语句，或给定视图的CREATE VIEW语句。</p><h4 id="show-indexes" tabindex="-1"><a class="header-anchor" href="#show-indexes" aria-hidden="true">#</a> Show Indexes</h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.7.</p><p>Indexing Is Removed since 3.0! See <a href="https://cwiki.apache.org/confluence/display/Hive/IndexDev" target="_blank" rel="noopener noreferrer">Indexes design document</a></p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token punctuation">[</span>FORMATTED<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">INDEX</span><span class="token operator">|</span>INDEXES<span class="token punctuation">)</span> <span class="token keyword">ON</span> table_with_index <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">FROM</span><span class="token operator">|</span><span class="token operator">IN</span><span class="token punctuation">)</span> db_name<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>SHOW INDEXES显示某个列上的所有索引，以及关于它们的信息:索引名、表名、用作键的列名、索引表名、索引类型和注释。如果使用FORMATTED关键字，则打印每列的列标题。</p><h3 id="show-columns" tabindex="-1"><a class="header-anchor" href="#show-columns" aria-hidden="true">#</a> Show Columns</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-2909" target="_blank" rel="noopener noreferrer">Hive 0.10</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token punctuation">(</span><span class="token keyword">FROM</span><span class="token operator">|</span><span class="token operator">IN</span><span class="token punctuation">)</span> table_name <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">FROM</span><span class="token operator">|</span><span class="token operator">IN</span><span class="token punctuation">)</span> db_name<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>SHOW COLUMNS显示表中的所有列，包括分区列。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><div class="language-text ext-text"><pre class="language-text"><code>SHOW COLUMNS (FROM|IN) table_name [(FROM|IN) db_name]  [ LIKE &#39;pattern_with_wildcards&#39;];
</code></pre></div><p>Added in Hive 3.0 by <a href="https://issues.apache.org/jira/browse/HIVE-18373" target="_blank" rel="noopener noreferrer">HIVE-18373</a>.</p></div><p><code>SHOW COLUMNS</code>列出表中名称与可选正则表达式匹配的所有列。正则表达式中的通配符只能为“*”，只能为“|”。例如“cola”，“col*”，“*a|col*”，这些都将匹配“cola”列。匹配的列按字母顺序列出。如果在表中没有找到匹配的列，则不是错误。如果没有给出正则表达式，则列出所选表中的所有列。</p><p><strong>Examples</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token comment">-- SHOW COLUMNS</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> test_db<span class="token punctuation">;</span>
<span class="token keyword">USE</span> test_db<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> foo<span class="token punctuation">(</span>col1 <span class="token keyword">INT</span><span class="token punctuation">,</span> col2 <span class="token keyword">INT</span><span class="token punctuation">,</span> col3 <span class="token keyword">INT</span><span class="token punctuation">,</span> cola <span class="token keyword">INT</span><span class="token punctuation">,</span> colb <span class="token keyword">INT</span><span class="token punctuation">,</span> colc <span class="token keyword">INT</span><span class="token punctuation">,</span> a <span class="token keyword">INT</span><span class="token punctuation">,</span> b <span class="token keyword">INT</span><span class="token punctuation">,</span> c <span class="token keyword">INT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token comment">-- SHOW COLUMNS basic syntax</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> foo<span class="token punctuation">;</span>                            <span class="token comment">-- show all column in foo</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> foo <span class="token string">&quot;*&quot;</span><span class="token punctuation">;</span>                        <span class="token comment">-- show all column in foo</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token operator">IN</span> foo <span class="token string">&quot;col*&quot;</span><span class="token punctuation">;</span>                       <span class="token comment">-- show columns in foo starting with &quot;col&quot;                 OUTPUT col1,col2,col3,cola,colb,colc</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> foo <span class="token string">&#39;*c&#39;</span><span class="token punctuation">;</span>                       <span class="token comment">-- show columns in foo ending with &quot;c&quot;                     OUTPUT c,colc</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> foo <span class="token operator">LIKE</span> <span class="token string">&quot;col1|cola&quot;</span><span class="token punctuation">;</span>           <span class="token comment">-- show columns in foo either col1 or cola                 OUTPUT col1,cola</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> foo <span class="token keyword">FROM</span> test_db <span class="token operator">LIKE</span> <span class="token string">&#39;col*&#39;</span><span class="token punctuation">;</span>   <span class="token comment">-- show columns in foo starting with &quot;col&quot;                 OUTPUT col1,col2,col3,cola,colb,colc</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token operator">IN</span> foo <span class="token operator">IN</span> test_db <span class="token operator">LIKE</span> <span class="token string">&#39;col*&#39;</span><span class="token punctuation">;</span>       <span class="token comment">-- show columns in foo starting with &quot;col&quot; (FROM/IN same)  OUTPUT col1,col2,col3,cola,colb,colc</span>
  
<span class="token comment">-- Non existing column pattern resulting in no match</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token operator">IN</span> foo <span class="token string">&quot;nomatch*&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token operator">IN</span> foo <span class="token string">&quot;col+&quot;</span><span class="token punctuation">;</span>                       <span class="token comment">-- + wildcard not supported</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token operator">IN</span> foo <span class="token string">&quot;nomatch&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="show-functions" tabindex="-1"><a class="header-anchor" href="#show-functions" aria-hidden="true">#</a> Show Functions</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> FUNCTIONS <span class="token punctuation">[</span><span class="token operator">LIKE</span> <span class="token string">&quot;&lt;pattern&gt;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SHOW FUNCTIONS</code>列出所有用户定义和内置函数，如果指定了LIKE，则通过正则表达式进行筛选。</p><h3 id="show-granted-roles-and-privileges" tabindex="-1"><a class="header-anchor" href="#show-granted-roles-and-privileges" aria-hidden="true">#</a> Show Granted Roles and Privileges</h3><p><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173" target="_blank" rel="noopener noreferrer">Hive deprecated authorization mode / Legacy Mode</a> has information about these SHOW statements:</p><ul><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-ViewingGrantedRoles" target="_blank" rel="noopener noreferrer">SHOW ROLE GRANT</a></li><li><a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=45876173#Hivedeprecatedauthorizationmode/LegacyMode-ViewingGrantedPrivileges" target="_blank" rel="noopener noreferrer">SHOW GRANT</a></li></ul><p>In Hive 0.13.0 and later releases, <a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization" target="_blank" rel="noopener noreferrer">SQL standard based authorization</a> has these SHOW statements:</p><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowRoleGrant" target="_blank" rel="noopener noreferrer">SHOW ROLE GRANT</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowGrant" target="_blank" rel="noopener noreferrer">SHOW GRANT</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowCurrentRoles" target="_blank" rel="noopener noreferrer">SHOW CURRENT ROLES</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowRoles" target="_blank" rel="noopener noreferrer">SHOW ROLES</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization#SQLStandardBasedHiveAuthorization-ShowPrincipals" target="_blank" rel="noopener noreferrer">SHOW PRINCIPALS</a></li></ul><h3 id="show-locks" tabindex="-1"><a class="header-anchor" href="#show-locks" aria-hidden="true">#</a> Show Locks</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> LOCKS <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> LOCKS <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span> <span class="token keyword">EXTENDED</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> LOCKS <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>partition_spec<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> LOCKS <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span> <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>partition_spec<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token keyword">EXTENDED</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> LOCKS <span class="token punctuation">(</span><span class="token keyword">DATABASE</span><span class="token operator">|</span><span class="token keyword">SCHEMA</span><span class="token punctuation">)</span> database_name<span class="token punctuation">;</span>     <span class="token comment">-- (Note: Hive 0.13.0 and later; SCHEMA added in Hive 0.14.0)</span>
</code></pre></div><p>SHOW LOCKS显示表或分区上的锁。有关锁的信息，请参见<a href="https://cwiki.apache.org/confluence/display/Hive/Locking" target="_blank" rel="noopener noreferrer">Hive Concurrency Model</a> 。</p><p>SHOW LOCKS (DATABASE|SCHEMA)由Hive 0.13的数据库(参见<a href="https://issues.apache.org/jira/browse/HIVE-2093" target="_blank" rel="noopener noreferrer">Hive -2093</a>)和Hive 0.14的SCHEMA(参见<a href="https://issues.apache.org/jira/browse/HIVE-6601" target="_blank" rel="noopener noreferrer">Hive -6601</a>)支持。SCHEMA和DATABASE是可互换的——它们的意思是一样的。</p><p>当<a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">Hive transactions</a>正在被使用时，SHOW LOCKS返回此信息(参见<a href="https://issues.apache.org/jira/browse/HIVE-6460" target="_blank" rel="noopener noreferrer">Hive -6460</a>))：</p><ul><li>database name</li><li>table name</li><li>partition name (if the table is partitioned)</li><li>the state the lock is in, which can be: <ul><li>&quot;acquired&quot; – the requestor holds the lock</li><li>&quot;waiting&quot; – the requestor is waiting for the lock</li><li>&quot;aborted&quot; – the lock has timed out but has not yet been cleaned up</li></ul></li><li>Id of the lock blocking this one, if this lock is in &quot;waiting&quot; state</li><li>the type of lock, which can be: <ul><li>&quot;exclusive&quot; – no one else can hold the lock at the same time (obtained mostly by DDL operations such as drop table)</li><li>&quot;shared_read&quot; – any number of other shared_read locks can lock the same resource at the same time (obtained by reads; confusingly, an insert operation also obtains a shared_read lock)</li><li>&quot;shared_write&quot; – any number of shared_read locks can lock the same resource at the same time, but no other shared_write locks are allowed (obtained by update and delete)</li></ul></li><li>ID of the transaction this lock is associated with, if there is one</li><li>last time the holder of this lock sent a heartbeat indicating it was still alive</li><li>the time the lock was acquired, if it has been acquired</li><li>Hive user who requested the lock</li><li>host the user is running on</li><li>agent info – a string that helps identify the entity that issued the lock request. For a SQL client this is the query ID, for streaming client it may be Storm bolt ID for example.</li></ul><h3 id="show-conf" tabindex="-1"><a class="header-anchor" href="#show-conf" aria-hidden="true">#</a> Show Conf</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-6037" target="_blank" rel="noopener noreferrer">Hive 0.14.0</a>.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> CONF <span class="token operator">&lt;</span>configuration_name<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>SHOW CONF返回指定<a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties" target="_blank" rel="noopener noreferrer">configuration property</a>的描述。</p><ul><li>default value</li><li>required type</li><li>description</li></ul><p>注意，SHOW CONF不会显示配置属性的当前值。对于当前的属性设置，请使用CLI中的“set”命令或HiveQL脚本(参见<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Commands" target="_blank" rel="noopener noreferrer">Commands</a>)或在Beeline中(参见<a href="https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients#HiveServer2Clients-BeelineHiveCommands" target="_blank" rel="noopener noreferrer">Beeline HiveCommands</a>)。</p><h3 id="show-transactions" tabindex="-1"><a class="header-anchor" href="#show-transactions" aria-hidden="true">#</a> Show Transactions</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-6460" target="_blank" rel="noopener noreferrer">Hive 0.13.0</a> (see <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">Hive Transactions</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">TRANSACTIONS</span><span class="token punctuation">;</span>
</code></pre></div><p>SHOW TRANSACTIONS供管理员在<a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">Hive TRANSACTIONS</a>被使用时使用。它返回系统中所有当前打开和终止的事务的列表，包括以下信息:</p><ul><li>transaction ID</li><li>transaction state</li><li>user who started the transaction</li><li>machine where the transaction was started</li><li>timestamp when the transaction was started (as of <a href="https://issues.apache.org/jira/browse/HIVE-11957" target="_blank" rel="noopener noreferrer">Hive 2.2.0</a>)</li><li>timestamp for last heartbeat (as of <a href="https://issues.apache.org/jira/browse/HIVE-11957" target="_blank" rel="noopener noreferrer">Hive 2.2.0</a> )</li></ul><h3 id="show-compactions" tabindex="-1"><a class="header-anchor" href="#show-compactions" aria-hidden="true">#</a> Show Compactions</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-6460" target="_blank" rel="noopener noreferrer">Hive 0.13.0</a> (see <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-BasicDesign" target="_blank" rel="noopener noreferrer">Hive Transactions</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> COMPACTIONS<span class="token punctuation">;</span>
</code></pre></div><p><a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-SHOWCOMPACTIONS" target="_blank" rel="noopener noreferrer">SHOW COMPACTIONS</a>返回当前正在<a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-BasicDesign" target="_blank" rel="noopener noreferrer">compacted</a>或计划在<a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions" target="_blank" rel="noopener noreferrer">Hive transactions</a>被使用时进行压缩的所有表和分区的列表，包括以下信息:</p><ul><li>&quot;CompactionId&quot; - unique internal id (As of <a href="https://issues.apache.org/jira/browse/HIVE-16084" target="_blank" rel="noopener noreferrer">Hive 3.0</a>)</li><li>&quot;Database&quot; - Hive database name</li><li>&quot;Table&quot; - table name</li><li>&quot;Partition&quot; - partition name (if the table is partitioned)</li><li>&quot;Type&quot; - whether it is a major or minor compaction</li><li>&quot;State&quot; - the state the compaction is in, which can be: <ul><li>&quot;initiated&quot; – waiting in the queue to be compacted</li><li>&quot;working&quot; – being compacted</li><li>&quot;ready for cleaning&quot; – the compaction has been done and the old files are scheduled to be cleaned</li><li>&quot;failed&quot; – the job failed. The metastore log will have more detail.</li><li>&quot;succeeded&quot; – A-ok</li><li>&quot;attempted&quot; – initiator attempted to schedule a compaction but failed. The metastore log will have more information.</li></ul></li><li>&quot;Worker&quot; - thread ID of the worker thread doing the compaction (only if in working state)</li><li>&quot;Start Time&quot; - the time at which the compaction started (only if in working or ready for cleaning state)</li><li>&quot;Duration(ms)&quot; - time this compaction took (As of <a href="https://issues.apache.org/jira/browse/HIVE-15337" target="_blank" rel="noopener noreferrer">Hive 2.2</a> )</li><li>&quot;HadoopJobId&quot; - Id of the submitted Hadoop job (As of <a href="https://issues.apache.org/jira/browse/HIVE-15337" target="_blank" rel="noopener noreferrer">Hive 2.2</a>)</li></ul><p>Compactions are initiated automatically, but can also be initiated manually with an <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AlterTable/PartitionCompact" target="_blank" rel="noopener noreferrer">ALTER TABLE COMPACT statement</a>.</p><h2 id="describe" tabindex="-1"><a class="header-anchor" href="#describe" aria-hidden="true">#</a> Describe</h2><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DescribeDatabase" target="_blank" rel="noopener noreferrer">Describe Database</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DescribeDataconnector" target="_blank" rel="noopener noreferrer">Describe Dataconnector</a></li><li>Describe Table/View/Materialized View/Column <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DisplayColumnStatistics" target="_blank" rel="noopener noreferrer">Display Column Statistics</a></li></ul></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DescribePartition" target="_blank" rel="noopener noreferrer">Describe Partition</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Hive2.0+:SyntaxChange" target="_blank" rel="noopener noreferrer">Hive 2.0+: Syntax Change</a></li></ul><h3 id="describe-database" tabindex="-1"><a class="header-anchor" href="#describe-database" aria-hidden="true">#</a> Describe Database</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.7.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token punctuation">]</span> db_name<span class="token punctuation">;</span>
<span class="token keyword">DESCRIBE</span> <span class="token keyword">SCHEMA</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token punctuation">]</span> db_name<span class="token punctuation">;</span>     <span class="token comment">-- (Note: Hive 1.1.0 and later)</span>
</code></pre></div><p><code>DESCRIBE DATABASE</code>显示数据库的名称、它的注释(如果已经设置了注释)以及它在文件系统上的根位置。SCHEMA和DATABASE的用法是可以互换的——它们的意思是一样的。Hive 1.1.0 (<a href="https://issues.apache.org/jira/browse/HIVE-8803" target="_blank" rel="noopener noreferrer">Hive -8803</a>)中增加了DESCRIBE SCHEMA。</p><p><code>EXTENDED</code> 还显示 <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateDatabase" target="_blank" rel="noopener noreferrer">database properties</a>.</p><h3 id="describe-dataconnector" tabindex="-1"><a class="header-anchor" href="#describe-dataconnector" aria-hidden="true">#</a> Describe Dataconnector</h3><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> CONNECTOR <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token punctuation">]</span> connector_name<span class="token punctuation">;</span>
</code></pre></div><p>Since Hive 4.0.0 via <a href="https://issues.apache.org/jira/browse/HIVE-24396" target="_blank" rel="noopener noreferrer">HIVE-24396</a></p><p>DESCRIBE CONNECTOR显示了连接器的名称、它的注释(如果已经设置了注释)、它的数据源URL和数据源类型。</p><p>EXTENDED还显示了数据连接器的属性。任何明文密码设置将以明文形式呈现。</p><h3 id="describe-table-view-materialized-view-column" tabindex="-1"><a class="header-anchor" href="#describe-table-view-materialized-view-column" aria-hidden="true">#</a> Describe Table/View/Materialized View/Column</h3><p>根据是否指定数据库，描述表/视图/物化视图/列语法有两种格式。</p><p>如果未指定数据库，则可选列信息在点号后面提供：</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token operator">|</span>FORMATTED<span class="token punctuation">]</span> 
  table_name<span class="token punctuation">[</span><span class="token punctuation">.</span>col_name <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$elem$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$key$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$value$&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
                                        <span class="token comment">-- (Note: Hive 1.x.x and 0.x.x only. See &quot;Hive 2.0+: New Syntax&quot; below)</span>
</code></pre></div><p>如果指定了数据库，则可选列信息在空格后提供:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token operator">|</span>FORMATTED<span class="token punctuation">]</span> 
  <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name<span class="token punctuation">[</span> col_name <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$elem$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$key$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$value$&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
                                        <span class="token comment">-- (Note: Hive 1.x.x and 0.x.x only. See &quot;Hive 2.0+: New Syntax&quot; below)</span>
</code></pre></div><p><code>DESCRIBE</code>显示给定表的分区列的列表。如果指定了EXTENDED关键字，那么它将以Thrift序列化形式显示表的所有元数据。这通常只对调试有用，不适用于一般用途。如果指定了格式化关键字，则它将以表格形式显示元数据。</p><p>注意:DESCRIBE EXTENDED仅在数据加载时收集统计数据时显示行数(参见<a href="https://cwiki.apache.org/confluence/display/Hive/StatsDev#StatsDev-NewlyCreatedTables" target="_blank" rel="noopener noreferrer">新创建的表</a>)，并且如果使用Hive CLI而不是Thrift客户端或Beeline。<a href="https://issues.apache.org/jira/browse/HIVE-6285" target="_blank" rel="noopener noreferrer">HIVE-6285</a>将解决此问题。虽然ANALYZE TABLE在数据加载后收集统计信息(参见<a href="https://cwiki.apache.org/confluence/display/Hive/StatsDev#StatsDev-ExistingTables" target="_blank" rel="noopener noreferrer">Existing Tables</a>)，但它目前没有提供关于行数的信息。</p><p>如果一个表有一个复杂的列，那么你可以通过指定table_name.complex_col_name(和field_name用于结构元素，&#39;$elem$&#39;用于数组元素，&#39;$key$&#39;用于映射键，&#39;$value$&#39;用于映射值)来检查这个列的属性。您可以递归地指定它来研究复杂的列类型。</p><p>对于视图，可以使用DESCRIBE EXTENDED或formatting来检索视图的定义。提供了两个相关的属性:用户指定的原始视图定义和Hive内部使用的扩展定义。</p><p>对于物化视图，DESCRIBE EXTENDED或formatting提供了关于是否启用重写以及给定的物化视图是否被认为是最新的，以便对它所使用的源表中的数据进行自动重写的附加信息。</p><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息 — partition &amp; non-partition columns</p><p>In Hive 0.10.0 and earlier, no distinction is made between partition columns and non-partition columns while displaying columns for DESCRIBE TABLE. From Hive 0.12.0 onwards, they are displayed separately.</p><p>In Hive 0.13.0 and later, the configuration parameter <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.display.partition.cols.separately" target="_blank" rel="noopener noreferrer">hive.display.partition.cols.separately</a> lets you use the old behavior, if desired (<a href="https://issues.apache.org/jira/browse/HIVE-6689" target="_blank" rel="noopener noreferrer">HIVE-6689</a>). For an example, see the test case in the <a href="https://issues.apache.org/jira/secure/attachment/12635956/HIVE-6689.2.patch" target="_blank" rel="noopener noreferrer">patch for HIVE-6689</a>.</p></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">Bug fixed in Hive 0.10.0 — database qualifiers</p><p>Database qualifiers for table names were introduced in Hive 0.7.0, but they were broken for DESCRIBE until a bug fix in Hive 0.10.0 (<a href="https://issues.apache.org/jira/browse/HIVE-1977" target="_blank" rel="noopener noreferrer">HIVE-1977</a>).</p></div><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">Bug fixed in Hive 0.13.0 — quoted identifiers</p><p>Prior to Hive 0.13.0 DESCRIBE did not accept backticks (`) surrounding table identifiers, so DESCRIBE could not be used for tables with names that matched reserved keywords (<a href="https://issues.apache.org/jira/browse/HIVE-2949" target="_blank" rel="noopener noreferrer">HIVE-2949</a> and <a href="https://issues.apache.org/jira/browse/HIVE-6187" target="_blank" rel="noopener noreferrer">HIVE-6187</a>). As of 0.13.0, all identifiers specified within backticks are treated literally when the configuration parameter <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.support.quoted.identifiers" target="_blank" rel="noopener noreferrer">hive.support.quoted.identifiers</a> has its default value of &quot;<code>column</code>&quot; (<a href="https://issues.apache.org/jira/browse/HIVE-6013" target="_blank" rel="noopener noreferrer">HIVE-6013</a>). The only exception is that double backticks (``) represent a single backtick character.</p></div><h4 id="display-column-statistics" tabindex="-1"><a class="header-anchor" href="#display-column-statistics" aria-hidden="true">#</a> <strong>Display Column Statistics</strong></h4><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of Hive 0.14.0; see <a href="https://issues.apache.org/jira/browse/HIVE-7050" target="_blank" rel="noopener noreferrer">HIVE-7050</a> and <a href="https://issues.apache.org/jira/browse/HIVE-7051" target="_blank" rel="noopener noreferrer">HIVE-7051</a>. (The FOR COLUMNS option of ANALYZE TABLE is available as of <a href="https://issues.apache.org/jira/browse/HIVE-1362" target="_blank" rel="noopener noreferrer">Hive 0.10.0</a>.)</p></div><p>ANALYZE TABLE <em>table_name</em> COMPUTE STATISTICS FOR COLUMNS将计算指定表中所有列的列统计信息(如果表已分区，则为所有分区)。要查看收集的列统计信息，可以使用以下语句:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> FORMATTED <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name column_name<span class="token punctuation">;</span>                              <span class="token comment">-- (Note: Hive 0.14.0 and later)</span>
<span class="token keyword">DESCRIBE</span> FORMATTED <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name column_name <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partition_spec<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- (Note: Hive 0.14.0 to 1.x.x)</span>
                                                                                  <span class="token comment">-- (see &quot;Hive 2.0+: New Syntax&quot; below)</span>
</code></pre></div><p>有关ANALYZE TABLE命令的更多信息，请参见 <a href="https://cwiki.apache.org/confluence/display/Hive/StatsDev#StatsDev-ExistingTables" target="_blank" rel="noopener noreferrer">Statistics in Hive: Existing Tables</a> 。</p><h3 id="describe-partition" tabindex="-1"><a class="header-anchor" href="#describe-partition" aria-hidden="true">#</a> Describe Partition</h3><p>根据是否指定数据库，有两种描述分区语法格式。</p><p>如果未指定数据库，则可选列信息在点号后面提供:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token operator">|</span>FORMATTED<span class="token punctuation">]</span> table_name<span class="token punctuation">[</span><span class="token punctuation">.</span>column_name<span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">;</span>
                                        <span class="token comment">-- (Note: Hive 1.x.x and 0.x.x only. See &quot;Hive 2.0+: New Syntax&quot; below)</span>
</code></pre></div><p>如果指定了数据库，则可选列信息在空格后提供:</p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span><span class="token operator">|</span>FORMATTED<span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name <span class="token punctuation">[</span>column_name<span class="token punctuation">]</span> <span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">;</span>
                                        <span class="token comment">-- (Note: Hive 1.x.x and 0.x.x only. See &quot;Hive 2.0+: New Syntax&quot; below)</span>
</code></pre></div><p>该语句列出给定分区的元数据。输出与description table_name类似。目前，在准备计划时不使用与特定分区关联的列信息。从Hive 1.2开始(<a href="https://issues.apache.org/jira/browse/HIVE-10307" target="_blank" rel="noopener noreferrer">Hive -10307</a>)，当 <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.typecheck.on.insert" target="_blank" rel="noopener noreferrer">hive.typecheck.on.insert</a> (被设置为true(默认为true)时，<em>partition_spec</em>中指定的分区列值将被类型验证，转换并归一化为它们的列类型</p><p><strong>Example:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code>hive<span class="token operator">&gt;</span> <span class="token keyword">show</span> partitions part_table<span class="token punctuation">;</span>
OK
d<span class="token operator">=</span>abc
 
 
hive<span class="token operator">&gt;</span> <span class="token keyword">DESCRIBE</span> <span class="token keyword">extended</span> part_table <span class="token keyword">partition</span> <span class="token punctuation">(</span>d<span class="token operator">=</span><span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
OK
i                       <span class="token keyword">int</span>                                        
d                       string                                     
                  
<span class="token comment"># Partition Information         </span>
<span class="token comment"># col_name              data_type               comment            </span>
                  
d                       string                                     
                  
Detailed <span class="token keyword">Partition</span> Information  <span class="token keyword">Partition</span><span class="token punctuation">(</span><span class="token keyword">values</span>:<span class="token punctuation">[</span>abc<span class="token punctuation">]</span><span class="token punctuation">,</span> dbName:<span class="token keyword">default</span><span class="token punctuation">,</span> tableName:part_table<span class="token punctuation">,</span> createTime:<span class="token number">1459382234</span><span class="token punctuation">,</span> lastAccessTime:<span class="token number">0</span><span class="token punctuation">,</span> sd:StorageDescriptor<span class="token punctuation">(</span>cols:<span class="token punctuation">[</span>FieldSchema<span class="token punctuation">(</span>name:i<span class="token punctuation">,</span> <span class="token keyword">type</span>:<span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">comment</span>:<span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> FieldSchema<span class="token punctuation">(</span>name:d<span class="token punctuation">,</span> <span class="token keyword">type</span>:string<span class="token punctuation">,</span> <span class="token keyword">comment</span>:<span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> location:<span class="token keyword">file</span>:<span class="token operator">/</span>tmp<span class="token operator">/</span>warehouse<span class="token operator">/</span>part_table<span class="token operator">/</span>d<span class="token operator">=</span>abc<span class="token punctuation">,</span> inputFormat:org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>TextInputFormat<span class="token punctuation">,</span> outputFormat:org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>io<span class="token punctuation">.</span>HiveIgnoreKeyTextOutputFormat<span class="token punctuation">,</span> compressed:<span class="token boolean">false</span><span class="token punctuation">,</span> numBuckets:<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> serdeInfo:SerDeInfo<span class="token punctuation">(</span>name:<span class="token boolean">null</span><span class="token punctuation">,</span> serializationLib:org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>serde2<span class="token punctuation">.</span>lazy<span class="token punctuation">.</span>LazySimpleSerDe<span class="token punctuation">,</span> parameters:{serialization<span class="token punctuation">.</span>format<span class="token operator">=</span><span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">,</span> bucketCols:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sortCols:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters:{}<span class="token punctuation">,</span> skewedInfo:SkewedInfo<span class="token punctuation">(</span>skewedColNames:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> skewedColValues:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> skewedColValueLocationMaps:{}<span class="token punctuation">)</span><span class="token punctuation">,</span> storedAsSubDirectories:<span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> parameters:{numFiles<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> COLUMN_STATS_ACCURATE<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span> transient_lastDdlTime<span class="token operator">=</span><span class="token number">1459382234</span><span class="token punctuation">,</span> numRows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> totalSize<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> rawDataSize<span class="token operator">=</span><span class="token number">1</span>}<span class="token punctuation">)</span>  
<span class="token keyword">Time</span> taken: <span class="token number">0.325</span> seconds<span class="token punctuation">,</span> Fetched: <span class="token number">9</span> <span class="token keyword">row</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
 
 
hive<span class="token operator">&gt;</span> <span class="token keyword">DESCRIBE</span> formatted part_table <span class="token keyword">partition</span> <span class="token punctuation">(</span>d<span class="token operator">=</span><span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
OK
<span class="token comment"># col_name              data_type               comment            </span>
                  
i                       <span class="token keyword">int</span>                                        
                  
<span class="token comment"># Partition Information         </span>
<span class="token comment"># col_name              data_type               comment            </span>
                  
d                       string                                     
                  
<span class="token comment"># Detailed Partition Information                </span>
<span class="token keyword">Partition</span> <span class="token keyword">Value</span>:        <span class="token punctuation">[</span>abc<span class="token punctuation">]</span>                   
<span class="token keyword">Database</span>:               <span class="token keyword">default</span>                 
<span class="token keyword">Table</span>:                  part_table              
CreateTime:             Wed Mar <span class="token number">30</span> <span class="token number">16</span>:<span class="token number">57</span>:<span class="token number">14</span> PDT <span class="token number">2016</span>    
LastAccessTime:         UNKNOWN                 
Protect <span class="token keyword">Mode</span>:           None                    
Location:               <span class="token keyword">file</span>:<span class="token operator">/</span>tmp<span class="token operator">/</span>warehouse<span class="token operator">/</span>part_table<span class="token operator">/</span>d<span class="token operator">=</span>abc    
<span class="token keyword">Partition</span> Parameters:           
        COLUMN_STATS_ACCURATE   <span class="token boolean">true</span>               
        numFiles                <span class="token number">1</span>                  
        numRows                 <span class="token number">1</span>                  
        rawDataSize             <span class="token number">1</span>                  
        totalSize               <span class="token number">2</span>                  
        transient_lastDdlTime   <span class="token number">1459382234</span>         
                  
<span class="token comment"># Storage Information           </span>
SerDe Library:          org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>serde2<span class="token punctuation">.</span>lazy<span class="token punctuation">.</span>LazySimpleSerDe      
InputFormat:            org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>TextInputFormat        
OutputFormat:           org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>io<span class="token punctuation">.</span>HiveIgnoreKeyTextOutputFormat      
Compressed:             <span class="token keyword">No</span>                      
Num Buckets:            <span class="token operator">-</span><span class="token number">1</span>                      
Bucket <span class="token keyword">Columns</span>:         <span class="token punctuation">[</span><span class="token punctuation">]</span>                      
Sort <span class="token keyword">Columns</span>:           <span class="token punctuation">[</span><span class="token punctuation">]</span>                      
Storage <span class="token keyword">Desc</span> Params:            
        serialization<span class="token punctuation">.</span>format    <span class="token number">1</span>                  
<span class="token keyword">Time</span> taken: <span class="token number">0.334</span> seconds<span class="token punctuation">,</span> Fetched: <span class="token number">35</span> <span class="token keyword">row</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre></div><h3 id="hive-2-0-syntax-change" tabindex="-1"><a class="header-anchor" href="#hive-2-0-syntax-change" aria-hidden="true">#</a> Hive 2.0+: Syntax Change</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">Hive 2.0+: New syntax</p><p>In Hive 2.0 release onward, the describe table command has a syntax change which is backward incompatible. See <a href="https://issues.apache.org/jira/browse/HIVE-12184" target="_blank" rel="noopener noreferrer">HIVE-12184</a> for details.</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> <span class="token punctuation">[</span><span class="token keyword">EXTENDED</span> <span class="token operator">|</span> FORMATTED<span class="token punctuation">]</span>
    <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> <span class="token punctuation">[</span>col_name <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$elem$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$key$&#39;</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token string">&#39;$value$&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>警告:新语法可能会破坏当前脚本：</p><ul><li><p>不再接受DOT分离的table_name和column_name。它们必须被空格分隔开。DB和TABLENAME用点分隔。column_name仍然可以包含复杂数据类型的DOTs。</p><p>可选的partition_spec必须出现在table_name之后，但在可选的column_name之前。在前面的语法中，column_name出现在table_name和partition_spec之间。</p></li></ul><p><strong>Examples:</strong></p><div class="language-sql ext-sql"><pre class="language-sql"><code><span class="token keyword">DESCRIBE</span> FORMATTED <span class="token keyword">default</span><span class="token punctuation">.</span>src_table <span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>part_col <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span> columnA<span class="token punctuation">;</span>
<span class="token keyword">DESCRIBE</span> <span class="token keyword">default</span><span class="token punctuation">.</span>src_thrift lintString<span class="token punctuation">.</span>$elem$<span class="token punctuation">.</span>myint<span class="token punctuation">;</span>
</code></pre></div><h2 id="abort" tabindex="-1"><a class="header-anchor" href="#abort" aria-hidden="true">#</a> Abort</h2><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-AbortTransactions" target="_blank" rel="noopener noreferrer">Abort Transactions</a></li></ul><h3 id="abort-transactions" tabindex="-1"><a class="header-anchor" href="#abort-transactions" aria-hidden="true">#</a> Abort Transactions</h3><div class="custom-container tip"><svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M297.6 258.73H296c-59.47.87-110.69 51.45-111.83 110.43-.626 36.485 16.525 71.085 45.94 92.68 17.86 13.18 29.88 33.56 33.77 56.42h67.62c4-22.82 16.13-43.3 34.16-56.74 28.589-21.097 45.496-54.587 45.496-90.118 0-30.03-12.078-58.833-33.496-79.882a113.133 113.133 0 0 0-80.06-32.79ZM265.19 550.7v26.6c0 4.84 1.17 6.43 1.17 6.43l63.72-.59V550.7h-64.89Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path><path d="M297.64 123.3C133.26 123.3 0 256.56 0 420.94s133.26 297.63 297.64 297.63 297.63-133.25 297.63-297.63S462 123.3 297.64 123.3ZM385 487.57c-14.11 10.48-22.51 28.09-22.51 47.14v48.43c-.016 17.792-14.648 32.428-32.44 32.45h-64.86c-15.6 0-32.44-12-32.44-38.29v-42.82c0-19-8.21-36.4-21.93-46.52-37.882-27.85-59.959-72.44-59.14-119.45 1.46-77.24 66-141.09 143.81-142.22 38.87.19 76.89 14.37 105 42.11a143.764 143.764 0 0 1 43.14 103c-.159 45.761-21.911 88.86-58.63 116.17Z" style="fill:#48b884;fill-rule:nonzero;" transform="matrix(.042 0 0 .042 0 -5.178)"></path></svg><p class="custom-container-title">版本信息</p><p>As of <a href="https://issues.apache.org/jira/browse/HIVE-12634" target="_blank" rel="noopener noreferrer">Hive 1.3.0 and 2.1.0</a> (see <a href="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-BasicDesign" target="_blank" rel="noopener noreferrer">Hive Transactions</a>).</p></div><div class="language-sql ext-sql"><pre class="language-sql"><code>ABORT <span class="token keyword">TRANSACTIONS</span> transactionID <span class="token punctuation">[</span> transactionID <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>ABORT TRANSACTIONS从Hive metastore中清除指定的事务id，这样用户就不需要直接与metastore交互来删除悬空或失败的事务。在Hive 1.3.0和2.1.0 (<a href="https://issues.apache.org/jira/browse/HIVE-12634" target="_blank" rel="noopener noreferrer">Hive -12634</a>)中增加了ABORT TRANSACTIONS。</p><p><strong>Example:</strong></p><div class="language-text ext-text"><pre class="language-text"><code>ABORT TRANSACTIONS 0000007 0000008 0000010 0000015;
</code></pre></div><p>该命令可与<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ShowTransactions" target="_blank" rel="noopener noreferrer">SHOW TRANSACTIONS</a>配合使用。后者可以帮助确定要清理的候选事务id。</p><h1 id="scheduled-queries" tabindex="-1"><a class="header-anchor" href="#scheduled-queries" aria-hidden="true">#</a> Scheduled queries</h1><p>文档可在 <a href="https://cwiki.apache.org/confluence/display/Hive/Scheduled+Queries" target="_blank" rel="noopener noreferrer">Scheduled Queries</a> 页面上获得。</p><h1 id="datasketches-integration" tabindex="-1"><a class="header-anchor" href="#datasketches-integration" aria-hidden="true">#</a> Datasketches integration</h1><p>文档可在 <a href="https://cwiki.apache.org/confluence/display/Hive/Datasketches+Integration" target="_blank" rel="noopener noreferrer">Datasketches Integration</a> 页面上获得。</p><h1 id="hcatalog-and-webhcat-ddl" tabindex="-1"><a class="header-anchor" href="#hcatalog-and-webhcat-ddl" aria-hidden="true">#</a> HCatalog and WebHCat DDL</h1><p>有关HCatalog和WebHCat中DDL的信息，请参见:</p><ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/HCatalog+CLI#HCatalogCLI-HCatalogDDL" target="_blank" rel="noopener noreferrer">HCatalog DDL</a> in the <a href="https://cwiki.apache.org/confluence/display/Hive/HCatalog" target="_blank" rel="noopener noreferrer">HCatalog manual</a></li><li><a href="https://cwiki.apache.org/confluence/display/Hive/WebHCat+Reference+AllDDL" target="_blank" rel="noopener noreferrer">WebHCat DDL Resources</a> in the <a href="https://cwiki.apache.org/confluence/display/Hive/WebHCat" target="_blank" rel="noopener noreferrer">WebHCat manual</a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><div class="pager"><a href="/post/2022/12/Hive%20%E8%AF%AD%E8%A8%80%E6%89%8B%E5%86%8C-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%AF%87/" class="prev">Previous <br><span>Hive 基本概念 数据类型篇</span></a><a href="/post/2023/02/Hive%20%E8%AF%AD%E8%A8%80%E6%89%8B%E5%86%8C-DML%E7%AF%87/" class="next">Next <br><span>Hive 基本概念 DML篇</span></a></div><!--]--><!----></main><ul class="catalog" style="top:0px;"><li class="level-2 toc-link-概览">概览</li><li class="level-2 toc-link-关键字">关键字</li><li class="level-2 toc-link-create-drop-alter-use-database">Create/Drop/Alter/Use Database</li><li class="level-3 toc-link-create-database">Create Database</li><li class="level-3 toc-link-drop-database">Drop Database</li><li class="level-3 toc-link-alter-database">Alter Database</li><li class="level-3 toc-link-use-database">Use Database</li><li class="level-2 toc-link-create-drop-alter-connector">Create/Drop/Alter Connector</li><li class="level-3 toc-link-create-connector">Create Connector</li><li class="level-3 toc-link-drop-connector">Drop Connector</li><li class="level-3 toc-link-alter-connector">Alter Connector</li><li class="level-2 toc-link-create-drop-truncate-table">Create/Drop/Truncate Table</li><li class="level-3 toc-link-create-table">Create Table</li><li class="level-3 toc-link-drop-table">Drop Table</li><li class="level-3 toc-link-truncate-table">Truncate Table</li><li class="level-2 toc-link-alter-table-partition-column">Alter Table/Partition/Column</li><li class="level-3 toc-link-alter-table">Alter Table</li><li class="level-3 toc-link-alter-partition">Alter Partition</li><li class="level-3 toc-link-alter-either-table-or-partition">Alter Either Table or Partition</li><li class="level-3 toc-link-alter-column">Alter Column</li><li class="level-2 toc-link-create-drop-alter-view">Create/Drop/Alter View</li><li class="level-3 toc-link-create-view">Create View</li><li class="level-3 toc-link-drop-view">Drop View</li><li class="level-3 toc-link-alter-view-properties">Alter View Properties</li><li class="level-3 toc-link-alter-view-as-select">Alter View As Select</li><li class="level-2 toc-link-create-drop-alter-materialized-view">Create/Drop/Alter Materialized View</li><li class="level-3 toc-link-create-index">Create Index</li><li class="level-3 toc-link-drop-index">Drop Index</li><li class="level-3 toc-link-alter-index">Alter Index</li><li class="level-2 toc-link-create-drop-macro">Create/Drop Macro</li><li class="level-3 toc-link-create-temporary-macro">Create Temporary Macro</li><li class="level-3 toc-link-drop-temporary-macro">Drop Temporary Macro</li><li class="level-2 toc-link-create-drop-reload-function">Create/Drop/Reload Function</li><li class="level-3 toc-link-temporary-functions">Temporary Functions</li><li class="level-3 toc-link-permanent-functions">Permanent Functions</li><li class="level-2 toc-link-create-drop-grant-revoke-roles-and-privileges">Create/Drop/Grant/Revoke Roles and Privileges</li><li class="level-2 toc-link-show">Show</li><li class="level-3 toc-link-show-databases">Show Databases</li><li class="level-3 toc-link-show-connectors">Show Connectors</li><li class="level-3 toc-link-show-tables-views-materialized-views-partitions-indexes">Show Tables/Views/Materialized Views/Partitions/Indexes</li><li class="level-3 toc-link-show-columns">Show Columns</li><li class="level-3 toc-link-show-functions">Show Functions</li><li class="level-3 toc-link-show-granted-roles-and-privileges">Show Granted Roles and Privileges</li><li class="level-3 toc-link-show-locks">Show Locks</li><li class="level-3 toc-link-show-conf">Show Conf</li><li class="level-3 toc-link-show-transactions">Show Transactions</li><li class="level-3 toc-link-show-compactions">Show Compactions</li><li class="level-2 toc-link-describe">Describe</li><li class="level-3 toc-link-describe-database">Describe Database</li><li class="level-3 toc-link-describe-dataconnector">Describe Dataconnector</li><li class="level-3 toc-link-describe-table-view-materialized-view-column">Describe Table/View/Materialized View/Column</li><li class="level-3 toc-link-describe-partition">Describe Partition</li><li class="level-3 toc-link-hive-2-0-syntax-change">Hive 2.0+: Syntax Change</li><li class="level-2 toc-link-abort">Abort</li><li class="level-3 toc-link-abort-transactions">Abort Transactions</li></ul></div><!--]--></div><div class="search-page" role="search"><span class="search-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="28" height="28" fill="currentColor"><path d="M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"></path></svg></span><div class="gungnir-search-box"><input placeholder="$ grep ..." autocomplete="off" spellcheck="false" value><!----></div></div><div class="menu-btn-container"><div class="menu-btn-wrapper"><div class="menu-btn"><div style="" class="menu-btn-icon"><span></span><span></span><span></span></div><div style="display:none;" class="menu-text">0</div><svg class="menu-progress"><circle class="menu-border" cx="50%" cy="50%" r="48%" style="stroke-dasharray:0% 314.15926%;"></circle></svg></div><div class="menu-btn-child-wrapper"><div title="toggle color mode" class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"/></svg><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 00283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"/></svg><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div><div class="menu-btn-child menu-toc-btn"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div><div class="toggle-sidebar-button menu-btn-child menu-btn-sidebar" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div><footer class="footer"><span>
                  &copy; Xiaobailong 2022-2023
                  <br>
                  Powered by <a href="https://vuepress.vuejs.org" target="_blank">VuePress</a> &
                  <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>
                </span></footer></div><!--]--></div>
    <script type="module" src="/assets/app.7f79d2e7.js" defer></script>
  </body>
</html>
